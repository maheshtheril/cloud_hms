generator client {
  provider   = "prisma-client-js"
  output     = "../node_modules/.prisma/client"
  engineType = "library"
}

datasource db {
  provider = "postgresql"
}

model account_chart {
  id                                                                                     String                        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                              String                        @db.Uuid
  company_id                                                                             String?                       @db.Uuid
  code                                                                                   String
  name                                                                                   String
  type_id                                                                                String?                       @db.Uuid
  is_active                                                                              Boolean                       @default(true)
  created_at                                                                             DateTime                      @default(now()) @db.Timestamptz(6)
  account_types                                                                          account_types?                @relation(fields: [type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  fiscal_position_account_map_fiscal_position_account_map_from_account_idToaccount_chart fiscal_position_account_map[] @relation("fiscal_position_account_map_from_account_idToaccount_chart")
  fiscal_position_account_map_fiscal_position_account_map_to_account_idToaccount_chart   fiscal_position_account_map[] @relation("fiscal_position_account_map_to_account_idToaccount_chart")
  ledger_posting_rules_ledger_posting_rules_credit_account_idToaccount_chart             ledger_posting_rules[]        @relation("ledger_posting_rules_credit_account_idToaccount_chart")
  ledger_posting_rules_ledger_posting_rules_debit_account_idToaccount_chart              ledger_posting_rules[]        @relation("ledger_posting_rules_debit_account_idToaccount_chart")
  posting_rules_posting_rules_credit_account_idToaccount_chart                           posting_rules[]               @relation("posting_rules_credit_account_idToaccount_chart")
  posting_rules_posting_rules_debit_account_idToaccount_chart                            posting_rules[]               @relation("posting_rules_debit_account_idToaccount_chart")
  tax_gl_accounts_tax_gl_accounts_input_account_idToaccount_chart                        tax_gl_accounts[]             @relation("tax_gl_accounts_input_account_idToaccount_chart")
  tax_gl_accounts_tax_gl_accounts_output_account_idToaccount_chart                       tax_gl_accounts[]             @relation("tax_gl_accounts_output_account_idToaccount_chart")
  tax_gl_accounts_tax_gl_accounts_reverse_charge_account_idToaccount_chart               tax_gl_accounts[]             @relation("tax_gl_accounts_reverse_charge_account_idToaccount_chart")

  @@unique([company_id, code])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model account_types {
  id             String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code           String          @unique
  name           String
  classification String
  created_at     DateTime        @default(now()) @db.Timestamptz(6)
  account_chart  account_chart[]
}

model accounting_periods {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String   @db.Uuid
  company_id   String   @db.Uuid
  period_label String
  date_from    DateTime @db.Date
  date_to      DateTime @db.Date
  is_open      Boolean  @default(true)
  created_at   DateTime @default(now()) @db.Timestamptz(6)

  @@unique([company_id, period_label])
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model accounts {
  id                                                    String                        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                             String                        @db.Uuid
  company_id                                            String                        @db.Uuid
  parent_id                                             String?                       @db.Uuid
  code                                                  String
  name                                                  String
  type                                                  String
  is_reconcilable                                       Boolean?                      @default(false)
  is_active                                             Boolean?                      @default(true)
  currency_id                                           String?                       @db.Uuid
  metadata                                              Json?                         @default("{}")
  created_at                                            DateTime?                     @default(now()) @db.Timestamptz(6)
  updated_at                                            DateTime?                     @default(now()) @db.Timestamptz(6)
  currencies                                            currencies?                   @relation(fields: [currency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  settings_ap                                           company_accounting_settings[] @relation("settings_ap")
  settings_ar                                           company_accounting_settings[] @relation("settings_ar")
  settings_cogs                                         company_accounting_settings[] @relation("settings_cogs")
  settings_exchange_gain_loss                           company_accounting_settings[] @relation("settings_exchange_gain_loss")
  settings_input_tax                                    company_accounting_settings[] @relation("settings_input_tax")
  settings_inventory                                    company_accounting_settings[] @relation("settings_inventory")
  settings_output_tax                                   company_accounting_settings[] @relation("settings_output_tax")
  settings_purchase                                     company_accounting_settings[] @relation("settings_purchase")
  settings_purchase_discount                            company_accounting_settings[] @relation("settings_purchase_discount")
  settings_retained_earnings                            company_accounting_settings[] @relation("settings_retained_earnings")
  settings_sales                                        company_accounting_settings[] @relation("settings_sales")
  settings_sales_discount                               company_accounting_settings[] @relation("settings_sales_discount")
  settings_stock_adjustment                             company_accounting_settings[] @relation("settings_stock_adjustment")
  product_category_expense                              hms_product_category[]        @relation("category_expense_account")
  product_category_income                               hms_product_category[]        @relation("category_income_account")
  journal_entry_lines                                   journal_entry_lines[]
  journal_lines                                         journal_lines[]
  journals_journals_default_credit_account_idToaccounts journals[]                    @relation("journals_default_credit_account_idToaccounts")
  journals_journals_default_debit_account_idToaccounts  journals[]                    @relation("journals_default_debit_account_idToaccounts")

  @@unique([company_id, code])
  @@index([company_id], map: "idx_accounts_company")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model agent_task {
  id            String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String    @db.Uuid
  lead_id       String?   @db.Uuid
  type          String
  handler       String?
  payload       Json?     @default("{}")
  status        String?   @default("pending")
  scheduled_for DateTime? @db.Timestamptz(6)
  started_at    DateTime? @db.Timestamptz(6)
  completed_at  DateTime? @db.Timestamptz(6)
  result        Json?
  created_at    DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model agent_task_log {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  task_id    String?   @db.Uuid
  step       String?
  meta       Json?
  created_at DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model ai_action {
  id              String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String    @db.Uuid
  session_id      String?   @db.Uuid
  lead_id         String?   @db.Uuid
  user_id         String?   @db.Uuid
  action_type     String
  payload         Json?     @default("{}")
  accepted        Boolean?
  executed        Boolean?  @default(false)
  executed_result Json?
  created_at      DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model ai_assistant_session {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  user_id    String?   @db.Uuid
  context    Json?     @default("{}")
  messages   Json?     @default("[]")
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model ai_embedding {
  id           String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  lead_id      String?   @db.Uuid
  namespace    String
  reference_id String?
  content      String?
  vector       Bytes?
  metadata     Json?     @default("{}")
  created_at   DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model analytic_accounts {
  id                      String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                  @db.Uuid
  company_id              String                  @db.Uuid
  code                    String
  name                    String
  type                    String
  parent_id               String?                 @db.Uuid
  is_active               Boolean                 @default(true)
  created_at              DateTime                @default(now()) @db.Timestamptz(6)
  analytic_accounts       analytic_accounts?      @relation("analytic_accountsToanalytic_accounts", fields: [parent_id], references: [id], onUpdate: NoAction)
  other_analytic_accounts analytic_accounts[]     @relation("analytic_accountsToanalytic_accounts")
  analytic_distribution   analytic_distribution[]
  journal_entry_lines     journal_entry_lines[]

  @@unique([company_id, code])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model analytic_distribution {
  id                String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String            @db.Uuid
  company_id        String            @db.Uuid
  analytic_id       String            @db.Uuid
  percentage        Decimal           @db.Decimal(5, 2)
  created_at        DateTime          @default(now()) @db.Timestamptz(6)
  analytic_accounts analytic_accounts @relation(fields: [analytic_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model analytic_tags {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String   @db.Uuid
  company_id String   @db.Uuid
  name       String
  created_at DateTime @default(now()) @db.Timestamptz(6)

  @@unique([company_id, name])
}

model app_user {
  id                        String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                 String                      @db.Uuid
  company_id                String?                     @db.Uuid
  email                     String
  name                      String?
  password                  String?
  is_admin                  Boolean?                    @default(false)
  is_active                 Boolean?                    @default(true)
  metadata                  Json?                       @default("{}")
  created_at                DateTime?                   @default(now()) @db.Timestamptz(6)
  full_name                 String?
  role                      String?
  is_platform_admin         Boolean                     @default(false)
  is_tenant_admin           Boolean                     @default(false)
  accounts                  crm_accounts[]
  contacts                  crm_contacts[]
  deals                     crm_deals[]
  leads                     crm_leads[]
  email_verification_tokens email_verification_tokens[]
  hms_user_roles            hms_user_roles[]
  user_permission           user_permission[]
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model attachment {
  id           String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  lead_id      String?   @db.Uuid
  company_id   String?   @db.Uuid
  uploaded_by  String?   @db.Uuid
  filename     String
  content_type String?
  size_bytes   BigInt?
  storage_key  String
  metadata     Json?     @default("{}")
  created_at   DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
/// This model or at least one of its fields has comments in the database, and requires an additional setup for migrations: Read more: https://pris.ly/d/database-comments
model audit_log {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String?   @db.Uuid
  actor_id   String?   @db.Uuid
  table_name String
  record_id  String?   @db.Uuid
  operation  String
  diff       Json?     @default("{}")
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  row_id     String?   @db.Uuid
  event      String?

  @@ignore
}

model business_partners {
  id               String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String   @db.Uuid
  name             String
  email            String?
  phone            String?
  website          String?
  gstin            String?
  pan              String?
  billing_address  Json?
  shipping_address Json?
  is_customer      Boolean  @default(true)
  is_vendor        Boolean  @default(false)
  is_partner       Boolean  @default(false)
  status           String?  @default("active")
  created_at       DateTime @default(now()) @db.Timestamptz(6)
  updated_at       DateTime @default(now()) @db.Timestamptz(6)

  @@index([tenant_id], map: "bp_tenant_idx")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model catalog_pipeline_template {
  id          String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  key         String
  name        String
  description String?
  metadata    Json?     @default("{}")
  created_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

model company {
  id                     String                   @unique(map: "uq_company_id") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String                   @db.Uuid
  name                   String
  enabled                Boolean?                 @default(true)
  metadata               Json?                    @default("{}")
  created_at             DateTime?                @default(now()) @db.Timestamptz(6)
  search_tsv             Unsupported("tsvector")?
  country_id             String?                  @db.Uuid
  industry               String?
  logo_url               String?
  mode                   String                   @default("trial")
  countries              countries?               @relation(fields: [country_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  company_menu_overrides company_menu_overrides[]
  company_settings       company_settings?
  company_taxes          company_taxes[]
  sessions               sessions[]

  @@index([tenant_id], map: "idx_company_tenant_id")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model company_accounting_settings {
  id                                                                       String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                String      @db.Uuid
  company_id                                                               String      @unique @db.Uuid
  default_sale_tax_id                                                      String?     @db.Uuid
  default_purchase_tax_id                                                  String?     @db.Uuid
  currency_id                                                              String?     @db.Uuid
  currency_precision                                                       Int         @default(2)
  rounding_method                                                          String      @default("ROUND_HALF_UP")
  fiscal_year_start                                                        DateTime    @default(dbgenerated("'2025-04-01'::date")) @db.Date
  fiscal_year_end                                                          DateTime    @default(dbgenerated("'2026-03-31'::date")) @db.Date
  ar_account_id                                                            String?     @db.Uuid
  ap_account_id                                                            String?     @db.Uuid
  sales_account_id                                                         String?     @db.Uuid
  purchase_account_id                                                      String?     @db.Uuid
  output_tax_account_id                                                    String?     @db.Uuid
  input_tax_account_id                                                     String?     @db.Uuid
  sales_journal_id                                                         String?     @db.Uuid
  purchase_journal_id                                                      String?     @db.Uuid
  cash_journal_id                                                          String?     @db.Uuid
  bank_journal_id                                                          String?     @db.Uuid
  general_journal_id                                                       String?     @db.Uuid
  localization                                                             String?
  enable_reverse_charge                                                    Boolean?    @default(true)
  enable_zero_rate                                                         Boolean?    @default(true)
  created_at                                                               DateTime    @default(now()) @db.Timestamptz(6)
  updated_at                                                               DateTime    @default(now()) @db.Timestamptz(6)
  cogs_account_id                                                          String?     @db.Uuid
  inventory_asset_account_id                                               String?     @db.Uuid
  lock_date                                                                DateTime?   @db.Date
  retained_earnings_account_id                                             String?     @db.Uuid
  stock_adjustment_account_id                                              String?     @db.Uuid
  exchange_gain_loss_account_id                                            String?     @db.Uuid
  purchase_discount_account_id                                             String?     @db.Uuid
  sales_discount_account_id                                                String?     @db.Uuid
  accounts_ap                                                              accounts?   @relation("settings_ap", fields: [ap_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_ar                                                              accounts?   @relation("settings_ar", fields: [ar_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journals_company_accounting_settings_bank_journal_idTojournals           journals?   @relation("company_accounting_settings_bank_journal_idTojournals", fields: [bank_journal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journals_company_accounting_settings_cash_journal_idTojournals           journals?   @relation("company_accounting_settings_cash_journal_idTojournals", fields: [cash_journal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_cogs                                                            accounts?   @relation("settings_cogs", fields: [cogs_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  currencies                                                               currencies? @relation(fields: [currency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_rates_company_accounting_settings_default_purchase_tax_idTotax_rates tax_rates?  @relation("company_accounting_settings_default_purchase_tax_idTotax_rates", fields: [default_purchase_tax_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_rates_company_accounting_settings_default_sale_tax_idTotax_rates     tax_rates?  @relation("company_accounting_settings_default_sale_tax_idTotax_rates", fields: [default_sale_tax_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_exchange_gain_loss                                              accounts?   @relation("settings_exchange_gain_loss", fields: [exchange_gain_loss_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journals_company_accounting_settings_general_journal_idTojournals        journals?   @relation("company_accounting_settings_general_journal_idTojournals", fields: [general_journal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_input_tax                                                       accounts?   @relation("settings_input_tax", fields: [input_tax_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_inventory                                                       accounts?   @relation("settings_inventory", fields: [inventory_asset_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_output_tax                                                      accounts?   @relation("settings_output_tax", fields: [output_tax_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_purchase                                                        accounts?   @relation("settings_purchase", fields: [purchase_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_purchase_discount                                               accounts?   @relation("settings_purchase_discount", fields: [purchase_discount_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journals_company_accounting_settings_purchase_journal_idTojournals       journals?   @relation("company_accounting_settings_purchase_journal_idTojournals", fields: [purchase_journal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_retained_earnings                                               accounts?   @relation("settings_retained_earnings", fields: [retained_earnings_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_sales                                                           accounts?   @relation("settings_sales", fields: [sales_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_sales_discount                                                  accounts?   @relation("settings_sales_discount", fields: [sales_discount_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journals_company_accounting_settings_sales_journal_idTojournals          journals?   @relation("company_accounting_settings_sales_journal_idTojournals", fields: [sales_journal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_stock_adjustment                                                accounts?   @relation("settings_stock_adjustment", fields: [stock_adjustment_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model company_menu_overrides {
  id                  String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  company_id          String     @db.Uuid
  menu_item_id        String     @db.Uuid
  enabled             Boolean?
  label_override      String?
  url_override        String?
  sort_order_override Int?
  created_at          DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?  @default(now()) @db.Timestamptz(6)
  company             company    @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  menu_items          menu_items @relation(fields: [menu_item_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([company_id, menu_item_id])
  @@index([company_id], map: "idx_cmo_company")
}

model company_settings {
  id                           String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                    String     @db.Uuid
  company_id                   String     @unique @db.Uuid
  currency_id                  String     @db.Uuid
  default_tax_type_id          String?    @db.Uuid
  default_tax_rate_id          String?    @db.Uuid
  rounding_precision           Int?       @default(2) @db.SmallInt
  numbering_prefix             String?    @default("INV") @db.VarChar(10)
  numbering_next               Int?       @default(1)
  address_country_id           String?    @db.Uuid
  auto_load_taxes_from_country Boolean?   @default(true)
  created_at                   DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at                   DateTime?  @default(now()) @db.Timestamptz(6)
  hms_sub_industry             String?
  hms_departments              Json?
  hms_billing_mode             String?
  company                      company    @relation(fields: [company_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  currencies                   currencies @relation(fields: [currency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_rates                    tax_rates? @relation(fields: [default_tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_types                    tax_types? @relation(fields: [default_tax_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant                       tenant     @relation(fields: [tenant_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([company_id], map: "idx_company_settings_company_id")
}

model company_tax_maps {
  id                String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String    @db.Uuid
  company_id        String    @db.Uuid
  country_id        String?   @db.Uuid
  tax_type_id       String    @db.Uuid
  tax_rate_id       String    @db.Uuid
  is_default        Boolean   @default(false)
  is_active         Boolean   @default(true)
  created_at        DateTime  @default(now()) @db.Timestamptz(6)
  updated_at        DateTime  @default(now()) @db.Timestamptz(6)
  account_id        String?   @db.Uuid
  refund_account_id String?   @db.Uuid
  tax_rates         tax_rates @relation(fields: [tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_types         tax_types @relation(fields: [tax_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([company_id, tax_type_id], map: "company_tax_maps_company_tax_type_uniq")
  @@index([company_id], map: "idx_company_tax_maps_company")
  @@index([company_id], map: "idx_company_tax_maps_company_id")
  @@index([tenant_id], map: "idx_company_tax_maps_tenant")
  @@index([tenant_id], map: "idx_company_tax_maps_tenant_id")
}

model company_taxes {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  company_id String   @db.Uuid
  name       String
  code       String?
  rate       Decimal  @default(0) @db.Decimal(10, 4)
  is_active  Boolean  @default(true)
  metadata   Json?    @default("{}")
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @default(now()) @db.Timestamptz(6)
  company    company  @relation(fields: [company_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([company_id], map: "idx_company_taxes_company_id")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model contact {
  id         String                   @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id  String?                  @db.Uuid
  search_tsv Unsupported("tsvector")?
  first_name String?
  last_name  String?
  email      String?
  phone      String?
  role_title String?
  meta       Json?                    @default("{}")
  created_at DateTime                 @default(now()) @db.Timestamptz(6)
  updated_at DateTime                 @default(now()) @db.Timestamptz(6)
  company_id String?                  @db.Uuid
  owner_id   String?                  @db.Uuid

  @@ignore
}

model countries {
  id                       String                     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  iso2                     String                     @unique @db.Char(2)
  iso3                     String                     @unique @db.Char(3)
  name                     String                     @db.VarChar(150)
  flag                     String                     @db.Char(4)
  region                   String?                    @db.VarChar(100)
  subregion                String?                    @db.VarChar(100)
  is_active                Boolean                    @default(true)
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  updated_at               DateTime                   @default(now()) @db.Timestamptz(6)
  company                  company[]
  country_default_currency country_default_currency[]
  country_tax_mappings     country_tax_mappings[]
}

model country_default_currency {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  country_id  String     @db.Uuid
  currency_id String     @db.Uuid
  is_active   Boolean    @default(true)
  created_at  DateTime?  @default(now()) @db.Timestamptz(6)
  countries   countries  @relation(fields: [country_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  currencies  currencies @relation(fields: [currency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model country_tax_mappings {
  id          String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  country_id  String    @db.Uuid
  tax_type_id String    @db.Uuid
  tax_rate_id String    @db.Uuid
  is_active   Boolean   @default(true)
  created_at  DateTime  @default(now()) @db.Timestamptz(6)
  updated_at  DateTime  @default(now()) @db.Timestamptz(6)
  countries   countries @relation(fields: [country_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_rates   tax_rates @relation(fields: [tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_types   tax_types @relation(fields: [tax_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([country_id, tax_type_id], map: "country_tax_mappings_country_tax_type_uniq")
  @@unique([country_id, tax_type_id], map: "country_tax_mappings_unique")
}

model currencies {
  id                                                        String                        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code                                                      String                        @unique @db.VarChar(3)
  name                                                      String                        @db.VarChar(100)
  symbol                                                    String?                       @db.VarChar(10)
  precision                                                 Int                           @default(2) @db.SmallInt
  is_active                                                 Boolean                       @default(true)
  created_at                                                DateTime                      @default(now()) @db.Timestamptz(6)
  updated_at                                                DateTime                      @default(now()) @db.Timestamptz(6)
  accounts                                                  accounts[]
  company_accounting_settings                               company_accounting_settings[]
  company_settings                                          company_settings[]
  country_default_currency                                  country_default_currency[]
  fx_gain_loss_fx_gain_loss_functional_currencyTocurrencies fx_gain_loss[]                @relation("fx_gain_loss_functional_currencyTocurrencies")
  fx_gain_loss_fx_gain_loss_original_currencyTocurrencies   fx_gain_loss[]                @relation("fx_gain_loss_original_currencyTocurrencies")
  fx_rates_fx_rates_base_currencyTocurrencies               fx_rates[]                    @relation("fx_rates_base_currencyTocurrencies")
  fx_rates_fx_rates_quote_currencyTocurrencies              fx_rates[]                    @relation("fx_rates_quote_currencyTocurrencies")
  journal_entries                                           journal_entries[]
  tenant_enabled_currencies                                 tenant_enabled_currencies[]

  @@index([code], map: "idx_currencies_code")
}

model custom_field_definition {
  id          String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  company_id  String?   @db.Uuid
  pipeline_id String?   @db.Uuid
  entity      String    @default("lead")
  key         String
  label       String
  field_type  String
  options     Json?
  required    Boolean?  @default(false)
  visible     Boolean?  @default(true)
  sort_order  Int?      @default(100)
  metadata    Json?     @default("{}")
  created_by  String?   @db.Uuid
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@unique([tenant_id, entity, key], map: "ux_cfd_base_tenant_entity_key")
}

model custom_field_value {
  id            String    @id(map: "pk_custom_field_value") @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  definition_id String    @db.Uuid
  tenant_id     String    @db.Uuid
  lead_id       String    @db.Uuid
  value_text    String?
  value_number  Decimal?  @db.Decimal
  value_boolean Boolean?
  value_json    Json?
  created_by    String?   @db.Uuid
  created_at    DateTime? @default(now()) @db.Timestamptz(6)

  @@unique([tenant_id, lead_id, definition_id], map: "uq_cfv_tenant_lead_definition")
  @@unique([tenant_id, lead_id, definition_id], map: "ux_cfv_tenant_lead_definition")
  @@index([lead_id], map: "ix_cfv_lead")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model custom_fields {
  id          String   @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String   @db.Uuid
  company_id  String?  @db.Uuid
  pipeline_id String?  @db.Uuid
  entity      String
  key         String
  label       String
  field_type  String
  options     Json?
  required    Boolean  @default(false)
  visible     Boolean  @default(true)
  sort_order  Int      @default(100)
  metadata    Json?
  created_by  String?  @db.Uuid
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  updated_at  DateTime @default(now()) @db.Timestamptz(6)

  @@ignore
}

model customer_loyalty_wallet {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String   @db.Uuid
  company_id  String   @db.Uuid
  customer_id String   @db.Uuid
  points      Decimal? @default(0) @db.Decimal(12, 2)
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model deals {
  id         String                   @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  tenant_id  String?                  @db.Uuid
  search_tsv Unsupported("tsvector")?

  @@ignore
}

model domain_mappings {
  id                 String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String    @db.Uuid
  host               String    @unique
  kind               String
  verified           Boolean   @default(false)
  verification_token String?
  cert_issued_at     DateTime? @db.Timestamptz(6)
  cert_expires_at    DateTime? @db.Timestamptz(6)
  created_at         DateTime? @default(now()) @db.Timestamptz(6)
  updated_at         DateTime? @default(now()) @db.Timestamptz(6)
  tenant             tenant    @relation(fields: [tenant_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model domain_policies {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  domain     String   @unique
  tenant_id  String?  @db.Uuid
  allow_all  Boolean? @default(false)
  created_at DateTime @default(now()) @db.Timestamptz(6)
  tenant     tenant?  @relation(fields: [tenant_id], references: [id], onUpdate: NoAction)
}

model email_verification_tokens {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id    String    @db.Uuid
  email      String
  token      String    @unique
  expires_at DateTime  @db.Timestamptz(6)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  app_user   app_user  @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([token], map: "idx_email_verification_token")
}

model express_session {
  sid    String   @id @db.VarChar
  sess   Json     @db.Json
  expire DateTime @db.Timestamp(6)

  @@index([expire], map: "IDX_express_session_expire")
}

model fiscal_position_account_map {
  id                                                                       String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  fiscal_position_id                                                       String           @db.Uuid
  from_account_id                                                          String           @db.Uuid
  to_account_id                                                            String           @db.Uuid
  created_at                                                               DateTime         @default(now()) @db.Timestamptz(6)
  fiscal_positions                                                         fiscal_positions @relation(fields: [fiscal_position_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  account_chart_fiscal_position_account_map_from_account_idToaccount_chart account_chart    @relation("fiscal_position_account_map_from_account_idToaccount_chart", fields: [from_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  account_chart_fiscal_position_account_map_to_account_idToaccount_chart   account_chart    @relation("fiscal_position_account_map_to_account_idToaccount_chart", fields: [to_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([fiscal_position_id, from_account_id])
}

model fiscal_position_tax_map {
  id                                                       String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  fiscal_position_id                                       String           @db.Uuid
  from_tax_id                                              String           @db.Uuid
  to_tax_id                                                String           @db.Uuid
  condition                                                Json?            @default("{}")
  created_at                                               DateTime         @default(now()) @db.Timestamptz(6)
  fiscal_positions                                         fiscal_positions @relation(fields: [fiscal_position_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tax_rates_fiscal_position_tax_map_from_tax_idTotax_rates tax_rates        @relation("fiscal_position_tax_map_from_tax_idTotax_rates", fields: [from_tax_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_rates_fiscal_position_tax_map_to_tax_idTotax_rates   tax_rates        @relation("fiscal_position_tax_map_to_tax_idTotax_rates", fields: [to_tax_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([fiscal_position_id, from_tax_id])
}

model fiscal_positions {
  id                          String                        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                   String                        @db.Uuid
  company_id                  String                        @db.Uuid
  name                        String
  description                 String?
  is_default                  Boolean                       @default(false)
  is_active                   Boolean                       @default(true)
  created_at                  DateTime                      @default(now()) @db.Timestamptz(6)
  updated_at                  DateTime                      @default(now()) @db.Timestamptz(6)
  fiscal_position_account_map fiscal_position_account_map[]
  fiscal_position_tax_map     fiscal_position_tax_map[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model fiscal_years {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  company_id String    @db.Uuid
  name       String
  date_start DateTime  @db.Date
  date_end   DateTime  @db.Date
  is_closed  Boolean?  @default(false)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  periods    periods[]
}

model fx_gain_loss {
  id                                                      String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                               String     @db.Uuid
  company_id                                              String     @db.Uuid
  journal_entry_id                                        String?    @db.Uuid
  original_currency                                       String     @db.Uuid
  functional_currency                                     String     @db.Uuid
  amount_original                                         Decimal    @db.Decimal(18, 6)
  amount_revalued                                         Decimal    @db.Decimal(18, 6)
  gain_loss                                               Decimal    @db.Decimal(18, 6)
  rate_date                                               DateTime   @db.Date
  created_at                                              DateTime   @default(now()) @db.Timestamptz(6)
  currencies_fx_gain_loss_functional_currencyTocurrencies currencies @relation("fx_gain_loss_functional_currencyTocurrencies", fields: [functional_currency], references: [id], onDelete: NoAction, onUpdate: NoAction)
  currencies_fx_gain_loss_original_currencyTocurrencies   currencies @relation("fx_gain_loss_original_currencyTocurrencies", fields: [original_currency], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model fx_rates {
  id                                             String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  base_currency                                  String     @db.Uuid
  quote_currency                                 String     @db.Uuid
  rate                                           Decimal    @db.Decimal(18, 8)
  rate_date                                      DateTime   @db.Date
  created_at                                     DateTime   @default(now()) @db.Timestamptz(6)
  currencies_fx_rates_base_currencyTocurrencies  currencies @relation("fx_rates_base_currencyTocurrencies", fields: [base_currency], references: [id], onDelete: NoAction, onUpdate: NoAction)
  currencies_fx_rates_quote_currencyTocurrencies currencies @relation("fx_rates_quote_currencyTocurrencies", fields: [quote_currency], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([base_currency, quote_currency, rate_date])
}

model fx_revaluation_runs {
  id               String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String   @db.Uuid
  company_id       String   @db.Uuid
  revaluation_date DateTime @db.Date
  currency_id      String   @db.Uuid
  created_at       DateTime @default(now()) @db.Timestamptz(6)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model global_settings {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String?  @db.Uuid
  company_id String?  @db.Uuid
  key        String
  value      Json
  scope      String   @default("global")
  version    Int      @default(1)
  created_by String?  @db.Uuid
  updated_by String?  @db.Uuid
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @default(now()) @db.Timestamptz(6)
}

model global_settings_history {
  id                 String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  global_settings_id String?   @db.Uuid
  tenant_id          String?   @db.Uuid
  company_id         String?   @db.Uuid
  key                String
  old_value          Json?
  new_value          Json?
  changed_by         String?   @db.Uuid
  changed_at         DateTime? @default(now()) @db.Timestamptz(6)
}

model global_stock {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  company_id  String    @db.Uuid
  product_id  String    @db.Uuid
  location_id String    @db.Uuid
  qty         Decimal   @default(0) @db.Decimal(14, 4)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@unique([product_id, location_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model global_stock_location {
  id            String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String    @db.Uuid
  company_id    String    @db.Uuid
  code          String?
  name          String
  location_type String?
  is_active     Boolean?  @default(true)
  created_at    DateTime? @default(now()) @db.Timestamptz(6)
}

model global_stock_lot {
  id            String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String    @db.Uuid
  company_id    String    @db.Uuid
  product_id    String    @db.Uuid
  lot_number    String?
  serial_number String?
  expiry_date   DateTime? @db.Date
  qty           Decimal?  @default(0) @db.Decimal(14, 4)
  created_at    DateTime? @default(now()) @db.Timestamptz(6)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model global_stock_move {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String    @db.Uuid
  company_id     String    @db.Uuid
  product_id     String    @db.Uuid
  location_from  String?   @db.Uuid
  location_to    String?   @db.Uuid
  qty            Decimal   @db.Decimal(14, 4)
  uom            String?   @default("unit")
  move_type      String?
  reference_type String?
  reference_id   String?   @db.Uuid
  cost           Decimal?  @db.Decimal(18, 4)
  created_by     String?   @db.Uuid
  created_at     DateTime? @default(now()) @db.Timestamptz(6)
}

model hms_admission {
  id               String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String         @db.Uuid
  company_id       String         @db.Uuid
  patient_id       String         @db.Uuid
  encounter_id     String?        @db.Uuid
  admitted_at      DateTime       @default(now()) @db.Timestamptz(6)
  discharged_at    DateTime?      @db.Timestamptz(6)
  ward             String?
  bed              String?
  admitting_doctor String?        @db.Uuid
  status           String?        @default("admitted")
  metadata         Json?          @default("{}")
  created_at       DateTime       @default(now()) @db.Timestamptz(6)
  hms_encounter    hms_encounter? @relation(fields: [encounter_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_patient      hms_patient    @relation(fields: [patient_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([admitted_at(sort: Desc)])
  @@index([bed])
  @@index([encounter_id], map: "hms_admission_encounter_idx")
  @@index([metadata], map: "hms_admission_metadata_gin", type: Gin)
  @@index([tenant_id, company_id, patient_id])
  @@index([ward])
}

model hms_ai_task {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String?   @db.Uuid
  company_id   String?   @db.Uuid
  entity_type  String?
  entity_id    String?   @db.Uuid
  prompt       String?
  result       String?
  status       String?   @default("pending")
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  processed_at DateTime? @db.Timestamptz(6)
}

model hms_appointment_logs {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String    @db.Uuid
  appointment_id String    @db.Uuid
  event          String
  payload        Json?
  created_at     DateTime? @default(now()) @db.Timestamptz(6)
  created_by     String?   @db.Uuid

  @@index([tenant_id, appointment_id], map: "idx_hms_appointment_logs_appointment")
  @@index([tenant_id, event], map: "idx_hms_appointment_logs_event")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hms_appointment_participants {
  id               String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String    @db.Uuid
  appointment_id   String    @db.Uuid
  participant_type String
  participant_id   String    @db.Uuid
  role             String?
  joined_at        DateTime? @db.Timestamptz(6)
  left_at          DateTime? @db.Timestamptz(6)

  @@index([tenant_id, appointment_id], map: "idx_hms_appointment_participants_appointment")
  @@index([tenant_id, participant_id], map: "idx_hms_appointment_participants_participant")
}

model hms_appointment_rules {
  id             String  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String? @db.Uuid
  company_id     String? @db.Uuid
  clinician_id   String? @db.Uuid
  visit_duration Int?    @default(15)
  working_days   Json?
  working_hours  Json?
  break_hours    Json?
  metadata       Json?
}

model hms_appointment_services {
  id             String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String   @db.Uuid
  appointment_id String   @db.Uuid
  service_id     String?  @db.Uuid
  qty            Decimal? @default(1) @db.Decimal(10, 2)
  unit_price     Decimal? @db.Decimal(12, 2)
  total_price    Decimal? @default(dbgenerated("(qty * COALESCE(unit_price, (0)::numeric))")) @db.Decimal(12, 2)
  is_billable    Boolean? @default(true)
  notes          String?

  @@index([tenant_id, appointment_id], map: "idx_hms_appointment_services_appointment")
}

model hms_appointment_tags {
  id             String @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String @db.Uuid
  appointment_id String @db.Uuid
  tag            String

  @@index([tenant_id, appointment_id], map: "idx_hms_appointment_tags_appointment")
  @@index([tenant_id, tag], map: "idx_hms_appointment_tags_tag")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hms_appointments {
  id               String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String         @db.Uuid
  company_id       String?        @db.Uuid
  patient_id       String         @db.Uuid
  clinician_id     String         @db.Uuid
  department_id    String?        @db.Uuid
  location_id      String?        @db.Uuid
  room_id          String?        @db.Uuid
  starts_at        DateTime       @db.Timestamptz(6)
  ends_at          DateTime       @db.Timestamptz(6)
  duration_minutes Int?           @default(dbgenerated("((EXTRACT(epoch FROM (ends_at - starts_at)) / (60)::numeric))::integer"))
  status           String         @default("scheduled")
  type             String?        @default("consultation")
  mode             String?        @default("in_person")
  priority         String?        @default("normal")
  notes            String?
  source           String?        @default("manual")
  ai_suggestion    Json?
  external_ref     String?
  created_at       DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?      @default(now()) @db.Timestamptz(6)
  created_by       String?        @db.Uuid
  updated_by       String?        @db.Uuid
  deleted_at       DateTime?      @db.Timestamptz(6)
  hms_clinician    hms_clinicians @relation(fields: [clinician_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_patient      hms_patient    @relation(fields: [patient_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_invoice      hms_invoice[]
  prescription     prescription[]
  hms_lab_order      hms_lab_order[]
  hms_imaging_order  hms_imaging_order[]

  @@index([clinician_id, starts_at], map: "idx_hms_appointments_clinician_starts_at")
  @@index([patient_id], map: "idx_hms_appointments_patient")
  @@index([tenant_id, starts_at], map: "idx_hms_appointments_tenant_starts_at")
  @@index([tenant_id, status], map: "idx_hms_appointments_tenant_status")
}

model hms_bed {
  id         String   @id @db.Uuid
  tenant_id  String   @db.Uuid
  company_id String   @db.Uuid
  ward_id    String   @db.Uuid
  bed_no     String
  status     String   @default("available")
  hms_ward   hms_ward @relation(fields: [ward_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model hms_billing_rule {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String?  @db.Uuid
  company_id    String?  @db.Uuid
  applies_to    String?
  applies_to_id String?  @db.Uuid
  billing_code  String?
  price         Decimal? @db.Decimal(14, 2)
  metadata      Json?    @default("{}")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hms_clinician_availability {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  clinician_id String    @db.Uuid
  date         DateTime? @db.Date
  day_of_week  Int?      @db.SmallInt
  start_time   DateTime? @db.Time(6)
  end_time     DateTime? @db.Time(6)
  repeat_rule  String?
  valid_from   DateTime? @db.Date
  valid_to     DateTime? @db.Date
  is_active    Boolean?  @default(true)
  notes        String?

  @@index([tenant_id, clinician_id], map: "idx_hms_clinician_availability_clinician")
  @@index([tenant_id, date], map: "idx_hms_clinician_availability_date")
}

model hms_clinicians {
  id                         String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                  String               @db.Uuid
  company_id                 String               @db.Uuid
  department_id              String?              @db.Uuid
  first_name                 String
  last_name                  String
  email                      String?              @unique
  phone                      String?
  role                       String?
  specialization             String?
  license_no                 String?
  experience_years           Int?
  is_active                  Boolean?             @default(true)
  created_at                 DateTime?            @default(now()) @db.Timestamptz(6)
  updated_at                 DateTime?            @default(now()) @db.Timestamptz(6)
  role_id                    String?              @db.Uuid
  specialization_id          String?              @db.Uuid
  consultation_end_time      String?              @default("17:00")
  consultation_slot_duration Int?                 @default(30)
  consultation_start_time    String?              @default("09:00")
  consultation_fee           Decimal?             @default(500) @db.Decimal(14, 2)
  designation                String?
  employee_id                String?              @unique
  qualification              String?
  working_days               String[]             @default(["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"])
  document_urls              Json?                @default("[]")
  profile_image_url          String?
  signature_url              String?
  hms_appointments           hms_appointments[]
  hms_roles                  hms_roles?           @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_specializations        hms_specializations? @relation(fields: [specialization_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model hms_credit_note {
  id                 String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String              @db.Uuid
  company_id         String              @db.Uuid
  invoice_id         String?             @db.Uuid
  credit_note_number String
  issued_at          DateTime            @default(now()) @db.Timestamptz(6)
  amount             Decimal             @db.Decimal(18, 2)
  reason             String?
  line_items         Json?               @default("[]")
  status             hms_invoice_status? @default(draft)
  created_by         String?             @db.Uuid
  created_at         DateTime            @default(now()) @db.Timestamptz(6)

  @@unique([tenant_id, company_id, credit_note_number], map: "ux_hms_credit_note_company_number")
}

model hms_departments {
  id                    String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id             String            @db.Uuid
  company_id            String            @db.Uuid
  name                  String
  code                  String?
  description           String?
  parent_id             String?           @db.Uuid
  is_active             Boolean?          @default(true)
  created_by            String?           @db.Uuid
  updated_by            String?           @db.Uuid
  created_at            DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at            DateTime?         @default(now()) @db.Timestamptz(6)
  deleted_at            DateTime?         @db.Timestamptz(6)
  hms_departments       hms_departments?  @relation("hms_departmentsTohms_departments", fields: [parent_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_parent_company")
  other_hms_departments hms_departments[] @relation("hms_departmentsTohms_departments")

  @@unique([company_id, name], map: "hms_departments_company_id_name_unique")
  @@unique([company_id, code], map: "unique_company_code")
  @@index([company_id], map: "idx_hms_dept_company")
  @@index([tenant_id, company_id], map: "idx_hms_dept_tenant_company")
}

model hms_diagnosis {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  encounter_id String?   @db.Uuid
  patient_id   String?   @db.Uuid
  icd_code     String?
  description  String?
  is_primary   Boolean?  @default(false)
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
}

model hms_doctor_role {
  id         String @id @db.Uuid
  tenant_id  String @db.Uuid
  company_id String @db.Uuid
  name       String
}

model hms_encounter {
  id             String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String          @db.Uuid
  company_id     String          @db.Uuid
  patient_id     String          @db.Uuid
  encounter_type String          @default("visit")
  started_at     DateTime        @default(now()) @db.Timestamptz(6)
  ended_at       DateTime?       @db.Timestamptz(6)
  clinician_id   String?         @db.Uuid
  metadata       Json?           @default("{}")
  created_at     DateTime        @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?       @default(now()) @db.Timestamptz(6)
  created_by     String?         @db.Uuid
  hms_admission  hms_admission[]
  hms_patient    hms_patient     @relation(fields: [patient_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_invoice    hms_invoice[]

  @@index([clinician_id])
  @@index([metadata], map: "hms_encounter_metadata_gin", type: Gin)
  @@index([started_at(sort: Desc)])
  @@index([tenant_id, company_id, started_at(sort: Desc)], map: "hms_encounter_tenant_company_started_idx")
  @@index([tenant_id, company_id, patient_id])
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model hms_fk_cleanup_log {
  cleaned_at      DateTime? @default(now()) @db.Timestamptz(6)
  table_name      String?
  constraint_name String?
  definition      String?

  @@ignore
}

model hms_idempotency_keys {
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String    @db.Uuid
  key_text        String
  created_by      String?   @db.Uuid
  created_at      DateTime? @default(now()) @db.Timestamptz(6)
  request_method  String?
  request_path    String?
  request_body    Json?
  response_status Int?
  response_body   Json?
  processed_at    DateTime? @db.Timestamptz(6)
  processed_by    String?   @db.Uuid

  @@unique([tenant_id, key_text], map: "hms_idempotency_keys_tenant_key_idx")
  @@unique([tenant_id, key_text], map: "uq_tenant_key")
  @@index([tenant_id, key_text], map: "idx_hms_idempotency_tenant_key")
}

model hms_imaging_image {
  id                 String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  series_id          String?             @db.Uuid
  sop_uid            String?
  thumbnail_url      String?
  storage_url        String?
  dicom_metadata     Json?
  created_at         DateTime?           @default(now()) @db.Timestamptz(6)
  hms_imaging_series hms_imaging_series? @relation(fields: [series_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model hms_imaging_order {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String              @db.Uuid
  company_id        String              @db.Uuid
  order_number      String?
  patient_id        String?             @db.Uuid
  encounter_id      String?             @db.Uuid
  modality          String?
  ordered_by        String?             @db.Uuid
  ordered_at        DateTime?           @default(now()) @db.Timestamptz(6)
  clinical_notes    String?
  priority          String?             @default("routine")
  status            String?             @default("requested")
  metadata          Json?               @default("{}")
  hms_patient       hms_patient?        @relation(fields: [patient_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_appointment   hms_appointments?   @relation(fields: [encounter_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_imaging_study hms_imaging_study[]
}

model hms_imaging_series {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  study_id          String?             @db.Uuid
  series_uid        String?
  body_part         String?
  modality          String?
  metadata          Json?               @default("{}")
  hms_imaging_image hms_imaging_image[]
  hms_imaging_study hms_imaging_study?  @relation(fields: [study_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model hms_imaging_study {
  id                 String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id           String?              @db.Uuid
  study_uid          String?
  description        String?
  performed_at       DateTime?            @db.Timestamptz(6)
  metadata           Json?                @default("{}")
  hms_imaging_series hms_imaging_series[]
  hms_imaging_order  hms_imaging_order?   @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

/// This model contains an index with non-default null sort order and requires additional setup for migrations. Visit https://pris.ly/d/default-index-null-ordering for more info.
model hms_invoice {
  id                      String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                    @db.Uuid
  company_id              String                    @db.Uuid
  patient_id              String?                   @db.Uuid
  encounter_id            String?                   @db.Uuid
  invoice_number          String
  issued_at               DateTime                  @default(now()) @db.Timestamptz(6)
  due_at                  DateTime?                 @db.Timestamptz(6)
  currency                String                    @default("INR")
  currency_rate           Decimal?                  @default(1) @db.Decimal(18, 8)
  subtotal                Decimal                   @default(0) @db.Decimal(18, 2)
  total_tax               Decimal                   @default(0) @db.Decimal(18, 2)
  total_discount          Decimal                   @default(0) @db.Decimal(18, 2)
  total                   Decimal                   @default(0) @db.Decimal(18, 2)
  total_paid              Decimal                   @default(0) @db.Decimal(18, 2)
  status                  hms_invoice_status        @default(draft)
  line_items              Json                      @default("[]")
  billing_metadata        Json?                     @default("{}")
  locked                  Boolean                   @default(false)
  created_by              String?                   @db.Uuid
  created_at              DateTime                  @default(now()) @db.Timestamptz(6)
  updated_at              DateTime                  @default(now()) @db.Timestamptz(6)
  outstanding             Decimal?                  @default(0) @db.Decimal(20, 6)
  invoice_no              String?
  invoice_date            DateTime?                 @db.Date
  due_date                DateTime?                 @db.Date
  posted_at               DateTime?                 @db.Timestamptz(6)
  outstanding_amount      Decimal?                  @default(0) @db.Decimal
  appointment_id          String?                   @db.Uuid
  hms_appointment         hms_appointments?         @relation(fields: [appointment_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_encounter           hms_encounter?            @relation(fields: [encounter_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_patient             hms_patient?              @relation(fields: [patient_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_invoice_lines       hms_invoice_lines[]
  hms_invoice_payments    hms_invoice_payments[]
  hms_payment_allocations hms_payment_allocations[]
  journal_entries         journal_entries[]

  @@unique([tenant_id, company_id, invoice_number], map: "ux_hms_invoice_company_number")
  @@index([tenant_id, company_id, issued_at(sort: Desc)], map: "ix_hms_invoice_tenant_company_issued_desc")
  @@index([tenant_id, company_id, status, issued_at], map: "ix_hms_invoice_tenant_company_status")
}

model hms_invoice_history {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String   @db.Uuid
  company_id  String   @db.Uuid
  invoice_id  String   @db.Uuid
  changed_at  DateTime @default(now()) @db.Timestamptz(6)
  changed_by  String?  @db.Uuid
  change_type String?
  delta       Json?
}

model hms_invoice_lines {
  id              String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String      @db.Uuid
  company_id      String      @db.Uuid
  invoice_id      String      @db.Uuid
  line_idx        Int
  line_ref        String?
  product_id      String?     @db.Uuid
  description     String?
  quantity        Decimal     @default(1) @db.Decimal(14, 4)
  uom             String?
  unit_price      Decimal     @default(0) @db.Decimal(18, 4)
  discount_amount Decimal     @default(0) @db.Decimal(18, 4)
  tax_amount      Decimal     @default(0) @db.Decimal(18, 4)
  net_amount      Decimal     @default(0) @db.Decimal(18, 4)
  account_code    String?
  metadata        Json?       @default("{}")
  created_at      DateTime    @default(now()) @db.Timestamptz(6)
  subtotal        Decimal?    @default(0) @db.Decimal(20, 6)
  tax_rate_id     String?     @db.Uuid
  hms_invoice     hms_invoice @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tax_rates       tax_rates?  @relation(fields: [tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([tenant_id, company_id, invoice_id], map: "ix_hms_invoice_lines_invoice")
  @@index([tenant_id, product_id], map: "ix_hms_invoice_lines_product")
  @@index([tenant_id, product_id], map: "ix_hms_invoice_lines_tenant_product")
}

model hms_invoice_payments {
  id                      String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                    @db.Uuid
  company_id              String                    @db.Uuid
  invoice_id              String                    @db.Uuid
  payment_reference       String?
  paid_at                 DateTime                  @default(now()) @db.Timestamptz(6)
  amount                  Decimal                   @db.Decimal(18, 2)
  currency                String                    @default("INR")
  method                  hms_payment_method
  metadata                Json?                     @default("{}")
  created_by              String?                   @db.Uuid
  created_at              DateTime                  @default(now()) @db.Timestamptz(6)
  hms_invoice             hms_invoice               @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_payment_allocations hms_payment_allocations[]

  @@index([tenant_id, invoice_id], map: "ix_hms_invoice_payments_invoice")
}

model hms_invoice_sequence {
  tenant_id   String @db.Uuid
  company_id  String @db.Uuid
  last_number BigInt @default(0)

  @@id([tenant_id, company_id], map: "pk_hms_invoice_sequence")
}

model hms_lab_order {
  id                  String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String                @db.Uuid
  company_id          String                @db.Uuid
  order_number        String?
  patient_id          String?               @db.Uuid
  encounter_id        String?               @db.Uuid
  ordered_by          String?               @db.Uuid
  ordered_at          DateTime?             @default(now()) @db.Timestamptz(6)
  status              String?               @default("requested")
  clinical_notes      String?
  priority            String?               @default("routine")
  billing_code        String?
  metadata            Json?                 @default("{}")
  created_at          DateTime?             @default(now()) @db.Timestamptz(6)
  hms_patient         hms_patient?          @relation(fields: [patient_id], references: [id], onUpdate: NoAction)
  hms_appointment     hms_appointments?     @relation(fields: [encounter_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_lab_order_line  hms_lab_order_line[]
  hms_lab_order_lines hms_lab_order_lines[]

  @@index([company_id], map: "idx_lab_order_company")
  @@index([patient_id], map: "ix_hms_lab_order_patient")
  @@index([status], map: "ix_hms_lab_order_status")
}

model hms_lab_order_line {
  id             String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String          @db.Uuid
  company_id     String          @db.Uuid
  order_id       String?         @db.Uuid
  test_id        String?         @db.Uuid
  sample_id      String?         @db.Uuid
  price          Decimal?        @db.Decimal(14, 2)
  status         String?         @default("pending")
  metadata       Json?           @default("{}")
  created_at     DateTime?       @default(now()) @db.Timestamptz(6)
  hms_lab_order  hms_lab_order?  @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_lab_sample hms_lab_sample? @relation(fields: [sample_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_lab_test   hms_lab_test?   @relation(fields: [test_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([order_id], map: "idx_lab_order_line_order")
}

model hms_lab_order_lines {
  id             String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String           @db.Uuid
  company_id     String           @db.Uuid
  order_id       String           @db.Uuid
  test_id        String           @db.Uuid
  sample_id      String?          @db.Uuid
  requested_code String?
  requested_name String?
  price          Decimal?         @default(0) @db.Decimal(18, 4)
  status         String?          @default("pending")
  result_id      String?          @db.Uuid
  created_at     DateTime?        @default(now()) @db.Timestamptz(6)
  hms_lab_order  hms_lab_order    @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_lab_sample hms_lab_sample?  @relation(fields: [sample_id], references: [id], onUpdate: NoAction)
  hms_lab_test   hms_lab_test     @relation(fields: [test_id], references: [id], onUpdate: NoAction)
  hms_lab_result hms_lab_result[]

  @@index([order_id], map: "ix_hms_lab_order_lines_order")
}

model hms_lab_result {
  id                  String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String               @db.Uuid
  company_id          String               @db.Uuid
  order_line_id       String?              @db.Uuid
  test_id             String?              @db.Uuid
  sample_id           String?              @db.Uuid
  result_value        String?
  numeric_value       Decimal?             @db.Decimal
  units               String?
  interpreted_value   String?
  reference_range     Json?
  reported_by         String?              @db.Uuid
  reported_at         DateTime?            @default(now()) @db.Timestamptz(6)
  verified_by         String?              @db.Uuid
  verified_at         DateTime?            @db.Timestamptz(6)
  attachments         Json?                @default("[]")
  metadata            Json?                @default("{}")
  created_at          DateTime?            @default(now()) @db.Timestamptz(6)
  hms_lab_order_lines hms_lab_order_lines? @relation(fields: [order_line_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_lab_sample      hms_lab_sample?      @relation(fields: [sample_id], references: [id], onUpdate: NoAction)
  hms_lab_test        hms_lab_test?        @relation(fields: [test_id], references: [id], onUpdate: NoAction)

  @@index([order_line_id], map: "ix_hms_lab_result_order_line")
  @@index([test_id], map: "ix_hms_lab_result_test")
}

model hms_lab_result_audit {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  result_id  String?   @db.Uuid
  changed_by String?   @db.Uuid
  changed_at DateTime? @default(now()) @db.Timestamptz(6)
  old        Json?
  new        Json?
}

model hms_lab_sample {
  id                      String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                @db.Uuid
  company_id              String                @db.Uuid
  sample_barcode          String?
  sample_type             String?
  collected_at            DateTime?             @db.Timestamptz(6)
  collected_by            String?               @db.Uuid
  collected_from_location String?
  received_at             DateTime?             @db.Timestamptz(6)
  received_by             String?               @db.Uuid
  status                  String?               @default("collected")
  metadata                Json?                 @default("{}")
  created_at              DateTime?             @default(now()) @db.Timestamptz(6)
  hms_lab_order_line      hms_lab_order_line[]
  hms_lab_order_lines     hms_lab_order_lines[]
  hms_lab_result          hms_lab_result[]

  @@index([company_id], map: "idx_lab_sample_company")
  @@index([sample_barcode], map: "ix_hms_lab_sample_barcode")
}

model hms_lab_test {
  id                                                                               String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                        String                      @db.Uuid
  company_id                                                                       String                      @db.Uuid
  code                                                                             String?
  loinc_code                                                                       String?
  name                                                                             String
  method                                                                           String?
  units                                                                            String?
  reference_range                                                                  Json?
  group_id                                                                         String?                     @db.Uuid
  is_panel                                                                         Boolean?                    @default(false)
  metadata                                                                         Json?                       @default("{}")
  created_by                                                                       String?                     @db.Uuid
  created_at                                                                       DateTime?                   @default(now()) @db.Timestamptz(6)
  updated_at                                                                       DateTime?                   @db.Timestamptz(6)
  hms_lab_order_line                                                               hms_lab_order_line[]
  hms_lab_order_lines                                                              hms_lab_order_lines[]
  hms_lab_result                                                                   hms_lab_result[]
  hms_lab_test_group                                                               hms_lab_test_group?         @relation(fields: [group_id], references: [id], onUpdate: NoAction)
  hms_lab_test_panel_member_hms_lab_test_panel_member_member_test_idTohms_lab_test hms_lab_test_panel_member[] @relation("hms_lab_test_panel_member_member_test_idTohms_lab_test")
  hms_lab_test_panel_member_hms_lab_test_panel_member_panel_idTohms_lab_test       hms_lab_test_panel_member[] @relation("hms_lab_test_panel_member_panel_idTohms_lab_test")

  @@index([company_id], map: "idx_lab_test_company")
  @@index([company_id, name], map: "ix_hms_lab_test_company_name")
  @@index([loinc_code], map: "ix_hms_lab_test_loinc")
}

model hms_lab_test_group {
  id           String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String         @db.Uuid
  company_id   String         @db.Uuid
  name         String
  description  String?
  is_active    Boolean?       @default(true)
  created_by   String?        @db.Uuid
  created_at   DateTime       @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?      @db.Timestamptz(6)
  metadata     Json?          @default("{}")
  hms_lab_test hms_lab_test[]

  @@unique([company_id, name], map: "hms_lab_test_group_company_name")
  @@unique([company_id, name], map: "hms_lab_test_group_company_name_unique")
  @@index([company_id], map: "idx_hms_lab_test_group_company")
  @@index([metadata], map: "idx_hms_lab_test_group_metadata", type: Gin)
  @@index([tenant_id], map: "idx_hms_lab_test_group_tenant")
}

model hms_lab_test_panel_member {
  panel_id                                                            String       @db.Uuid
  member_test_id                                                      String       @db.Uuid
  ord                                                                 Int?         @default(0) @db.SmallInt
  hms_lab_test_hms_lab_test_panel_member_member_test_idTohms_lab_test hms_lab_test @relation("hms_lab_test_panel_member_member_test_idTohms_lab_test", fields: [member_test_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_lab_test_hms_lab_test_panel_member_panel_idTohms_lab_test       hms_lab_test @relation("hms_lab_test_panel_member_panel_idTohms_lab_test", fields: [panel_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([panel_id, member_test_id])
}

model hms_medication_administration {
  id                   String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  medication_order_id  String?               @db.Uuid
  administered_by      String?               @db.Uuid
  administered_at      DateTime?             @default(now()) @db.Timestamptz(6)
  notes                String?
  hms_medication_order hms_medication_order? @relation(fields: [medication_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model hms_medication_order {
  id                            String                          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  patient_id                    String?                         @db.Uuid
  encounter_id                  String?                         @db.Uuid
  drug_id                       String?                         @db.Uuid
  dose                          String?
  frequency                     String?
  route                         String?
  duration                      String?
  notes                         String?
  created_by                    String?                         @db.Uuid
  created_at                    DateTime?                       @default(now()) @db.Timestamptz(6)
  hms_medication_administration hms_medication_administration[]
  hms_product                   hms_product?                    @relation(fields: [drug_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model hms_outbox {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String    @db.Uuid
  aggregate_type String
  aggregate_id   String?   @db.Uuid
  event_type     String
  payload        Json
  attempts       Int       @default(0)
  locked_at      DateTime? @db.Timestamptz(6)
  processed_at   DateTime? @db.Timestamptz(6)
  last_error     String?
  created_at     DateTime? @default(now()) @db.Timestamptz(6)

  @@index([tenant_id], map: "idx_hms_outbox_tenant")
  @@index([processed_at, locked_at, created_at], map: "idx_hms_outbox_unprocessed_created")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model hms_patient {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String              @db.Uuid
  company_id        String?             @db.Uuid
  patient_number    String?
  first_name        String
  last_name         String?
  dob               DateTime?           @db.Date
  gender            String?
  identifiers       Json?               @default("{}")
  contact           Json?               @default("{}")
  metadata          Json?               @default("{}")
  created_by        String?             @db.Uuid
  created_at        DateTime            @default(now()) @db.Timestamptz(6)
  updated_at        DateTime            @default(now()) @db.Timestamptz(6)
  external_id       String?
  status            String?             @default("active")
  merged_into       String?             @db.Uuid
  source_system     String?
  updated_by        String?             @db.Uuid
  full_name         String?             @default(dbgenerated("TRIM(BOTH ' '::text FROM ((COALESCE(first_name, ''::text) || ' '::text) || COALESCE(last_name, ''::text)))"))
  hms_admission     hms_admission[]
  hms_appointments  hms_appointments[]
  hms_encounter     hms_encounter[]
  hms_imaging_order hms_imaging_order[]
  hms_invoice       hms_invoice[]
  hms_lab_order     hms_lab_order[]
  hms_vitals        hms_vitals[]
  prescription      prescription[]

  @@index([contact], map: "hms_patient_contact_gin_idx", type: Gin)
  @@index([identifiers], map: "hms_patient_identifiers_gin_idx", type: Gin)
  @@index([metadata], map: "hms_patient_metadata_gin_idx", type: Gin)
  @@index([tenant_id, company_id])
}

model hms_patient_audit {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  patient_id String?   @db.Uuid
  operation  String?
  changed_at DateTime? @default(now()) @db.Timestamptz(6)
  changed_by String?   @db.Uuid
  row_data   Json?
}

model hms_patient_history {
  history_id BigInt   @id @default(autoincrement())
  patient_id String?  @db.Uuid
  tenant_id  String?  @db.Uuid
  operation  String
  changed_by String?  @db.Uuid
  changed_at DateTime @default(now()) @db.Timestamptz(6)
  old_data   Json?
  new_data   Json?
  diff       Json?

  @@index([patient_id], map: "hms_patient_history_patient_idx")
  @@index([tenant_id], map: "hms_patient_history_tenant_idx")
}

model hms_patient_insights {
  id                String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String   @db.Uuid
  patient_id        String   @db.Uuid
  risk_score        Int
  gender_suggestion String?
  anomalies         Json?    @default("[]")
  timeline_summary  String?
  computed_at       DateTime @default(now()) @db.Timestamptz(6)

  @@unique([tenant_id, patient_id], map: "ux_hms_patient_insights_tenant_patient")
  @@index([tenant_id, patient_id], map: "hms_patient_insights_tenant_patient_idx")
}

model hms_patient_version {
  version_id BigInt   @id @default(autoincrement())
  patient_id String   @db.Uuid
  tenant_id  String   @db.Uuid
  version_no Int
  data       Json
  created_at DateTime @default(now()) @db.Timestamptz(6)
  created_by String?  @db.Uuid

  @@unique([tenant_id, patient_id, version_no], map: "ux_hms_patient_version_tenant_no")
}

model hms_patient_registration_fees {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  company_id   String?   @db.Uuid
  fee_amount   Decimal   @db.Decimal(12, 2)
  validity_days Int      @default(365)
  is_active    Boolean   @default(true)
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime  @default(now()) @db.Timestamptz(6)

  @@index([tenant_id, is_active])
}

model hms_payment_allocations {
  id                   String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id            String               @db.Uuid
  company_id           String               @db.Uuid
  payment_id           String               @db.Uuid
  invoice_id           String               @db.Uuid
  allocated_amount     Decimal              @db.Decimal(18, 2)
  created_at           DateTime             @default(now()) @db.Timestamptz(6)
  hms_invoice          hms_invoice          @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_payment_allocations_invoice_fkey")
  hms_invoice_payments hms_invoice_payments @relation(fields: [payment_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_payment_allocations_payment_fkey")

  @@index([tenant_id, company_id, invoice_id], map: "ix_hms_payment_allocations_invoice")
  @@index([tenant_id, company_id, payment_id], map: "ix_hms_payment_allocations_payment")
}

model hms_procedure {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  encounter_id String?   @db.Uuid
  patient_id   String?   @db.Uuid
  cpt_code     String?
  description  String?
  performed_by String?   @db.Uuid
  performed_at DateTime? @db.Timestamptz(6)
  status       String?   @default("completed")
  notes        String?
}

model hms_product {
  id                         String                       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                  String                       @db.Uuid
  company_id                 String                       @db.Uuid
  sku                        String
  name                       String
  description                String?
  is_stockable               Boolean                      @default(true)
  is_service                 Boolean                      @default(false)
  uom                        String                       @default("each")
  valuation_method           String                       @default("fifo")
  price                      Decimal?                     @default(0) @db.Decimal(14, 2)
  currency                   String                       @default("USD")
  default_cost               Decimal?                     @default(0) @db.Decimal(14, 2)
  metadata                   Json?                        @default("{}")
  created_at                 DateTime                     @default(now()) @db.Timestamptz(6)
  created_by                 String?                      @db.Uuid
  updated_at                 DateTime?                    @db.Timestamptz(6)
  updated_by                 String?                      @db.Uuid
  deleted_at                 DateTime?                    @db.Timestamptz(6)
  is_active                  Boolean                      @default(true)
  default_barcode            String?
  barcode_type               String?
  manufacturer_id            String?                      @db.Uuid
  uom_id                     String?                      @db.Uuid
  hms_medication_order       hms_medication_order[]
  hms_manufacturer           hms_manufacturer?            @relation(fields: [manufacturer_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_uom                    hms_uom?                     @relation(fields: [uom_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_product_batch          hms_product_batch[]
  hms_product_category_rel   hms_product_category_rel[]
  hms_product_image          hms_product_image[]
  hms_product_price_history  hms_product_price_history[]
  hms_product_stock_ledger   hms_product_stock_ledger[]
  hms_product_supplier       hms_product_supplier[]
  hms_product_uom_conversion hms_product_uom_conversion[]
  hms_purchase_order_line    hms_purchase_order_line[]
  hms_stock_ledger           hms_stock_ledger[]
  hms_stock_levels           hms_stock_levels[]
  prescription_items         prescription_items[]
  product_tax_rules          product_tax_rules[]

  @@unique([tenant_id, sku], map: "ux_hms_product_tenant_sku")
  @@index([company_id], map: "ix_hms_product_company")
  @@index([metadata], map: "ix_hms_product_metadata_gin", type: Gin)
  @@index([name], map: "ix_hms_product_name")
  @@index([tenant_id], map: "ix_hms_product_tenant")
  @@index([uom], map: "ix_hms_product_uom")
}

model hms_product_batch {
  id                       String                     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                String                     @db.Uuid
  company_id               String                     @db.Uuid
  product_id               String                     @db.Uuid
  batch_no                 String
  expiry_date              DateTime?                  @db.Date
  mrp                      Decimal?                   @db.Decimal(14, 2)
  cost                     Decimal?                   @db.Decimal(14, 4)
  qty_on_hand              Decimal                    @default(0) @db.Decimal(16, 6)
  vendor_barcode           String?
  internal_barcode         String?
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  created_by               String?                    @db.Uuid
  metadata                 Json?                      @default("{}")
  manufacturer_id          String?                    @db.Uuid
  uom_id                   String?                    @db.Uuid
  margin_percentage        Decimal?                   @db.Decimal(5, 2)
  markup_percentage        Decimal?                   @db.Decimal(5, 2)
  pricing_strategy         String?
  sale_price               Decimal?                   @db.Decimal(14, 2)
  hms_manufacturer         hms_manufacturer?          @relation(fields: [manufacturer_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_product              hms_product                @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  hms_uom                  hms_uom?                   @relation(fields: [uom_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_product_stock_ledger hms_product_stock_ledger[]

  @@unique([tenant_id, company_id, product_id, batch_no], map: "ux_hms_product_batch")
  @@index([expiry_date], map: "ix_hms_product_batch_expiry")
  @@index([product_id], map: "ix_hms_product_batch_product")
}

model hms_product_category {
  id                       String                     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                String                     @db.Uuid
  company_id               String                     @db.Uuid
  name                     String
  slug                     String?
  metadata                 Json?                      @default("{}")
  created_at               DateTime                   @default(now()) @db.Timestamptz(6)
  default_tax_rate_id      String?                    @db.Uuid
  expense_account_id       String?                    @db.Uuid
  income_account_id        String?                    @db.Uuid
  tax_rates                tax_rates?                 @relation(fields: [default_tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_expense         accounts?                  @relation("category_expense_account", fields: [expense_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_income          accounts?                  @relation("category_income_account", fields: [income_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_product_category_rel hms_product_category_rel[]

  @@index([tenant_id], map: "ix_hms_product_category_tenant")
}

model hms_product_category_rel {
  product_id           String               @db.Uuid
  category_id          String               @db.Uuid
  hms_product_category hms_product_category @relation(fields: [category_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_prod_cat_rel_cat_fkey")
  hms_product          hms_product          @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_prod_cat_rel_prod_fkey")

  @@id([product_id, category_id], map: "hms_prod_cat_rel_pkey")
}

model hms_manufacturer {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String              @db.Uuid
  company_id        String              @db.Uuid
  name              String
  description       String?
  website           String?
  is_active         Boolean             @default(true)
  created_at        DateTime            @default(now()) @db.Timestamptz(6)
  updated_at        DateTime            @default(now()) @db.Timestamptz(6)
  hms_product       hms_product[]
  hms_product_batch hms_product_batch[]

  @@index([company_id], map: "ix_hms_manufacturer_company")
}

model hms_uom_category {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  company_id String    @db.Uuid
  name       String
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  hms_uom    hms_uom[]

  @@index([company_id], map: "ix_hms_uom_category_company")
}

model hms_uom {
  id                String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String              @db.Uuid
  company_id        String              @db.Uuid
  category_id       String              @db.Uuid
  name              String
  uom_type          String              @default("reference")
  ratio             Decimal             @default(1.0) @db.Decimal(10, 4)
  rounding          Decimal?            @default(0.01) @db.Decimal(10, 4)
  is_active         Boolean             @default(true)
  created_at        DateTime            @default(now()) @db.Timestamptz(6)
  hms_product       hms_product[]
  hms_product_batch hms_product_batch[]
  hms_uom_category  hms_uom_category    @relation(fields: [category_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([company_id], map: "ix_hms_uom_company")
}

model hms_product_image {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String      @db.Uuid
  company_id  String      @db.Uuid
  product_id  String      @db.Uuid
  url         String
  caption     String?
  created_at  DateTime    @default(now()) @db.Timestamptz(6)
  created_by  String?     @db.Uuid
  hms_product hms_product @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_product_image_prod_fkey")

  @@index([product_id], map: "ix_hms_product_image_product")
}

model hms_product_price_history {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String      @db.Uuid
  company_id  String      @db.Uuid
  product_id  String      @db.Uuid
  price       Decimal     @db.Decimal(14, 2)
  currency    String      @default("USD")
  valid_from  DateTime    @default(now()) @db.Timestamptz(6)
  valid_to    DateTime?   @db.Timestamptz(6)
  created_at  DateTime    @default(now()) @db.Timestamptz(6)
  created_by  String?     @db.Uuid
  metadata    Json?       @default("{}")
  hms_product hms_product @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_product_price_history_product_fkey")

  @@index([product_id, valid_from(sort: Desc)], map: "ix_hms_pricehist_product")
}

model hms_product_stock_ledger {
  id                String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String             @db.Uuid
  company_id        String             @db.Uuid
  product_id        String             @db.Uuid
  location          String?
  change_qty        Decimal            @db.Decimal(16, 6)
  balance_qty       Decimal            @db.Decimal(16, 6)
  movement_type     String
  reference         String?
  cost              Decimal?           @db.Decimal(14, 4)
  created_at        DateTime           @default(now()) @db.Timestamptz(6)
  created_by        String?            @db.Uuid
  metadata          Json?              @default("{}")
  batch_id          String?            @db.Uuid
  hms_product_batch hms_product_batch? @relation(fields: [batch_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_product       hms_product        @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_product_stock_ledger_product_fkey")

  @@index([product_id, batch_id, created_at(sort: Desc)], map: "ix_hms_stockledger_batch_product_created")
  @@index([movement_type], map: "ix_hms_stockledger_movement_type")
  @@index([product_id], map: "ix_hms_stockledger_product")
  @@index([product_id, created_at(sort: Desc)], map: "ix_hms_stockledger_product_created")
  @@index([tenant_id], map: "ix_hms_stockledger_tenant")
}

model hms_product_supplier {
  product_id     String       @db.Uuid
  supplier_id    String       @db.Uuid
  supplier_sku   String?
  lead_time_days Int?
  price          Decimal?     @db.Decimal(14, 2)
  currency       String?      @default("USD")
  company_id     String?      @db.Uuid
  is_primary     Boolean?     @default(false)
  tenant_id      String?      @db.Uuid
  hms_product    hms_product  @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_product_supplier_prod_fkey")
  hms_supplier   hms_supplier @relation(fields: [supplier_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_product_supplier_sup_fkey")

  @@id([product_id, supplier_id])
}

model hms_product_uom_conversion {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String      @db.Uuid
  company_id  String      @db.Uuid
  product_id  String      @db.Uuid
  from_uom    String
  to_uom      String
  factor      Decimal     @db.Decimal(16, 6)
  hms_product hms_product @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@unique([tenant_id, company_id, product_id, from_uom, to_uom])
  @@index([product_id], map: "ix_hms_uom_conv_product")
}

model hms_progress_notes {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  encounter_id String?   @db.Uuid
  patient_id   String?   @db.Uuid
  author_id    String?   @db.Uuid
  note         String?
  ai_note      String?
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  updated_at   DateTime? @db.Timestamptz(6)
}

model hms_purchase_invoice {
  id                        String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                 String                      @db.Uuid
  company_id                String                      @db.Uuid
  purchase_order_id         String?                     @db.Uuid
  supplier_id               String?                     @db.Uuid
  name                      String?
  invoice_date              DateTime?                   @db.Date
  due_date                  DateTime?                   @db.Date
  subtotal                  Decimal?                    @default(0) @db.Decimal(18, 6)
  tax_total                 Decimal?                    @default(0) @db.Decimal(18, 6)
  total_amount              Decimal?                    @default(0) @db.Decimal(22, 6)
  paid_amount               Decimal?                    @default(0) @db.Decimal(22, 6)
  currency                  String?                     @default("USD")
  status                    String?                     @default("draft")
  attachments               Json?                       @default("{}")
  metadata                  Json?                       @default("{}")
  created_at                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?                   @db.Timestamptz(6)
  hms_purchase_order        hms_purchase_order?         @relation(fields: [purchase_order_id], references: [id], onUpdate: NoAction, map: "hms_purchase_invoice_po_fkey")
  hms_supplier              hms_supplier?               @relation(fields: [supplier_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "hms_purchase_invoice_supplier_fkey")
  hms_purchase_invoice_line hms_purchase_invoice_line[]
  journal_entries           journal_entries[]

  @@index([supplier_id], map: "ix_hms_purchase_invoice_supplier")
}

model hms_purchase_invoice_line {
  id                      String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                   @db.Uuid
  company_id              String                   @db.Uuid
  invoice_id              String                   @db.Uuid
  po_line_id              String?                  @db.Uuid
  product_id              String?                  @db.Uuid
  description             String?
  qty                     Decimal?                 @default(0) @db.Decimal(20, 6)
  unit_price              Decimal?                 @default(0) @db.Decimal(18, 6)
  tax                     Json?                    @default("{}")
  line_total              Decimal?                 @default(0) @db.Decimal(22, 6)
  metadata                Json?                    @default("{}")
  created_at              DateTime                 @default(now()) @db.Timestamptz(6)
  hms_purchase_invoice    hms_purchase_invoice     @relation(fields: [invoice_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_invoice_line_invoice_fkey")
  hms_purchase_order_line hms_purchase_order_line? @relation(fields: [po_line_id], references: [id], onUpdate: NoAction, map: "hms_invoice_line_po_line_fkey")

  @@index([invoice_id], map: "ix_hms_purchase_invoice_line_invoice")
}

model hms_purchase_order {
  id                      String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                    @db.Uuid
  company_id              String                    @db.Uuid
  name                    String
  supplier_id             String                    @db.Uuid
  supplier_reference      String?
  order_date              DateTime                  @default(dbgenerated("CURRENT_DATE")) @db.Date
  expected_date           DateTime?                 @db.Date
  currency                String                    @default("USD")
  subtotal                Decimal?                  @default(0) @db.Decimal(18, 6)
  total_tax               Decimal?                  @default(0) @db.Decimal(18, 6)
  total_amount            Decimal?                  @default(0) @db.Decimal(22, 6)
  status                  hms_purchase_status?      @default(draft)
  notes                   String?
  attachments             Json?                     @default("{}")
  metadata                Json?                     @default("{}")
  created_at              DateTime                  @default(now()) @db.Timestamptz(6)
  created_by              String?                   @db.Uuid
  updated_at              DateTime?                 @db.Timestamptz(6)
  updated_by              String?                   @db.Uuid
  hms_purchase_invoice    hms_purchase_invoice[]
  hms_supplier            hms_supplier              @relation(fields: [supplier_id], references: [id], onUpdate: NoAction, map: "hms_purchase_order_supplier_fkey")
  hms_purchase_order_line hms_purchase_order_line[]
  hms_purchase_receipt    hms_purchase_receipt[]

  @@unique([tenant_id, company_id, name], map: "ux_hms_purchase_order_unique_name")
  @@index([company_id, status], map: "ix_hms_purchase_order_company_status")
  @@index([supplier_id], map: "ix_hms_purchase_order_supplier")
}

model hms_purchase_order_line {
  id                        String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                 String                      @db.Uuid
  company_id                String                      @db.Uuid
  purchase_order_id         String                      @db.Uuid
  line_no                   Int                         @default(10)
  product_id                String                      @db.Uuid
  product_name              String
  description               String?
  qty                       Decimal                     @default(0) @db.Decimal(20, 6)
  uom                       String?
  unit_price                Decimal                     @default(0) @db.Decimal(18, 6)
  discount_percent          Decimal?                    @default(0) @db.Decimal(7, 4)
  tax                       Json?                       @default("{}")
  tax_amount                Decimal?                    @default(0) @db.Decimal(18, 6)
  line_total                Decimal?                    @default(0) @db.Decimal(22, 6)
  received_qty              Decimal?                    @default(0) @db.Decimal(20, 6)
  batch_no                  String?
  metadata                  Json?                       @default("{}")
  created_at                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?                   @db.Timestamptz(6)
  hms_purchase_invoice_line hms_purchase_invoice_line[]
  hms_purchase_order        hms_purchase_order          @relation(fields: [purchase_order_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_po_line_po_fkey")
  hms_product               hms_product                 @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_purchase_receipt_line hms_purchase_receipt_line[]

  @@index([purchase_order_id], map: "ix_hms_purchase_order_line_po")
  @@index([product_id], map: "ix_hms_purchase_order_line_product")
}

model hms_purchase_receipt {
  id                        String                      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                 String                      @db.Uuid
  company_id                String                      @db.Uuid
  purchase_order_id         String?                     @db.Uuid
  name                      String?
  receipt_date              DateTime                    @default(dbgenerated("CURRENT_DATE")) @db.Date
  status                    hms_receipt_status?         @default(pending)
  received_by               String?                     @db.Uuid
  notes                     String?
  attachments               Json?                       @default("{}")
  metadata                  Json?                       @default("{}")
  created_at                DateTime                    @default(now()) @db.Timestamptz(6)
  updated_at                DateTime?                   @db.Timestamptz(6)
  supplier_id               String?                     @db.Uuid
  hms_purchase_order        hms_purchase_order?         @relation(fields: [purchase_order_id], references: [id], onUpdate: NoAction, map: "hms_purchase_receipt_po_fkey")
  hms_supplier              hms_supplier?               @relation(fields: [supplier_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "hms_purchase_receipt_supplier_fkey")
  hms_purchase_receipt_line hms_purchase_receipt_line[]

  @@index([company_id, status], map: "ix_hms_purchase_receipt_company_status")
  @@index([purchase_order_id], map: "ix_hms_purchase_receipt_po")
}

model hms_purchase_receipt_line {
  id                      String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                   @db.Uuid
  company_id              String                   @db.Uuid
  receipt_id              String                   @db.Uuid
  po_line_id              String?                  @db.Uuid
  product_id              String                   @db.Uuid
  qty                     Decimal                  @default(0) @db.Decimal(20, 6)
  uom                     String?
  unit_price              Decimal?                 @default(0) @db.Decimal(18, 6)
  batch_id                String?                  @db.Uuid
  batch_no                String?
  location_id             String?                  @db.Uuid
  lot_number              String?
  metadata                Json?                    @default("{}")
  created_at              DateTime                 @default(now()) @db.Timestamptz(6)
  hms_purchase_order_line hms_purchase_order_line? @relation(fields: [po_line_id], references: [id], onUpdate: NoAction, map: "hms_receipt_line_po_line_fkey")
  hms_purchase_receipt    hms_purchase_receipt     @relation(fields: [receipt_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_receipt_line_receipt_fkey")

  @@index([product_id], map: "ix_hms_purchase_receipt_line_product")
  @@index([receipt_id], map: "ix_hms_purchase_receipt_line_receipt")
}

model hms_role {
  id                   String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id            String                 @db.Uuid
  name                 String
  description          String?
  hms_role_permissions hms_role_permissions[]
  hms_user_roles       hms_user_roles[]

  @@unique([tenant_id, name])
}

model hms_role_permissions {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  role_id    String   @db.Uuid
  permission String
  hms_role   hms_role @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model hms_roles {
  id             String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String           @db.Uuid
  company_id     String?          @db.Uuid
  name           String
  code           String?
  description    String?
  is_clinical    Boolean?         @default(false)
  is_active      Boolean?         @default(true)
  created_at     DateTime?        @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?        @db.Timestamptz(6)
  hms_clinicians hms_clinicians[]

  @@unique([tenant_id, company_id, name], map: "hms_roles_tenant_company_name_unique")
  @@index([is_clinical], map: "idx_hms_roles_is_clinical")
  @@index([tenant_id, company_id], map: "idx_hms_roles_tenant_company")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hms_settings {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  company_id String?   @db.Uuid
  key        String
  value      Json
  scope      String
  version    Int       @default(1)
  updated_by String?   @db.Uuid
  updated_at DateTime? @default(now()) @db.Timestamptz(6)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  created_by String?   @db.Uuid
  is_active  Boolean?  @default(true)
  metadata   Json?     @default("{}")

  @@unique([tenant_id, company_id, key])
  @@index([company_id, key], map: "idx_hms_settings_company_key")
  @@index([tenant_id, key], map: "idx_hms_settings_tenant_key")
  @@index([value], map: "idx_hms_settings_value_gin", type: Gin)
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model hms_specializations {
  id             String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String           @db.Uuid
  company_id     String?          @db.Uuid
  name           String
  description    String?
  is_active      Boolean?         @default(true)
  created_at     DateTime?        @default(now()) @db.Timestamptz(6)
  updated_at     DateTime?        @db.Timestamptz(6)
  hms_clinicians hms_clinicians[]

  @@unique([tenant_id, company_id, name], map: "hms_specs_tenant_company_name_unique")
  @@index([tenant_id, company_id], map: "idx_hms_specs_tenant_company")
}

model hms_staff {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  company_id String    @db.Uuid
  name       String
  role       String?
  created_at DateTime? @default(now()) @db.Timestamptz(6)
}

model hms_stock_ledger {
  id               String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String      @db.Uuid
  company_id       String      @db.Uuid
  product_id       String      @db.Uuid
  related_type     String?
  related_id       String?     @db.Uuid
  movement_type    String
  qty              Decimal     @db.Decimal(20, 6)
  uom              String?
  unit_cost        Decimal?    @default(0) @db.Decimal(18, 6)
  total_cost       Decimal?    @default(0) @db.Decimal(22, 6)
  from_location_id String?     @db.Uuid
  to_location_id   String?     @db.Uuid
  batch_id         String?     @db.Uuid
  lot_number       String?
  reference        String?
  created_at       DateTime    @default(now()) @db.Timestamptz(6)
  metadata         Json?       @default("{}")
  hms_product      hms_product @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([company_id, product_id, created_at(sort: Desc)], map: "idx_hms_stock_ledger_product_time")
  @@index([related_type, related_id], map: "idx_hms_stock_ledger_related")
}

model hms_stock_levels {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String      @db.Uuid
  company_id  String      @db.Uuid
  product_id  String      @db.Uuid
  batch_id    String?     @db.Uuid
  location_id String      @db.Uuid
  quantity    Decimal     @default(0) @db.Decimal(20, 6)
  reserved    Decimal     @default(0) @db.Decimal(20, 6)
  updated_at  DateTime    @default(now()) @db.Timestamptz(6)
  metadata    Json?       @default("{}")
  hms_product hms_product @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "hms_stock_levels_product_fkey")

  @@unique([tenant_id, company_id, product_id, batch_id, location_id], map: "ux_hms_stock_levels_unique")
  @@index([company_id, product_id, location_id], map: "ix_hms_stock_levels_product_loc")
  @@index([tenant_id], map: "ix_hms_stock_levels_tenant")
}

model hms_stock_location {
  id                                                              String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                       String                  @db.Uuid
  company_id                                                      String                  @db.Uuid
  code                                                            String
  name                                                            String
  location_type                                                   hms_location_type       @default(warehouse)
  metadata                                                        Json?                   @default("{}")
  created_at                                                      DateTime                @default(now()) @db.Timestamptz(6)
  hms_stock_move_hms_stock_move_location_fromTohms_stock_location hms_stock_move[]        @relation("hms_stock_move_location_fromTohms_stock_location")
  hms_stock_move_hms_stock_move_location_toTohms_stock_location   hms_stock_move[]        @relation("hms_stock_move_location_toTohms_stock_location")
  hms_stock_reservation                                           hms_stock_reservation[]

  @@unique([tenant_id, company_id, code], map: "ux_hms_stock_location_company_code")
  @@index([tenant_id, company_id], map: "ix_hms_stock_location_company")
}

model hms_stock_locations {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String   @db.Uuid
  company_id String   @db.Uuid
  name       String
  code       String?
  is_default Boolean  @default(false)
  metadata   Json?    @default("{}")
  created_at DateTime @default(now()) @db.Timestamptz(6)
  created_by String?  @db.Uuid

  @@index([company_id], map: "ix_hms_stock_locations_company")
  @@index([tenant_id], map: "ix_hms_stock_locations_tenant")
}

model hms_stock_lot {
  id             String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String           @db.Uuid
  company_id     String           @db.Uuid
  product_id     String           @db.Uuid
  lot_number     String?
  serial_number  String?
  expiry_date    DateTime?        @db.Date
  quantity       Decimal          @default(0) @db.Decimal(14, 4)
  metadata       Json?            @default("{}")
  created_at     DateTime         @default(now()) @db.Timestamptz(6)
  hms_stock_move hms_stock_move[]

  @@index([tenant_id, company_id, product_id])
  @@index([tenant_id, company_id, product_id], map: "ix_hms_stock_lot_tenant_product")
}

model hms_stock_move {
  id                                                                  String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                           String                @db.Uuid
  company_id                                                          String                @db.Uuid
  product_id                                                          String                @db.Uuid
  location_from                                                       String?               @db.Uuid
  location_to                                                         String?               @db.Uuid
  lot_id                                                              String?               @db.Uuid
  qty                                                                 Decimal               @db.Decimal(14, 4)
  uom                                                                 String
  move_type                                                           hms_move_type
  source                                                              String?
  source_reference                                                    String?               @db.Uuid
  cost                                                                Decimal?              @db.Decimal(18, 4)
  created_by                                                          String?               @db.Uuid
  created_at                                                          DateTime              @default(now()) @db.Timestamptz(6)
  hms_stock_location_hms_stock_move_location_fromTohms_stock_location hms_stock_location?   @relation("hms_stock_move_location_fromTohms_stock_location", fields: [location_from], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_stock_location_hms_stock_move_location_toTohms_stock_location   hms_stock_location?   @relation("hms_stock_move_location_toTohms_stock_location", fields: [location_to], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_stock_lot                                                       hms_stock_lot?        @relation(fields: [lot_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_stock_valuation                                                 hms_stock_valuation[]

  @@index([tenant_id, company_id, product_id, created_at], map: "ix_hms_stock_move_company_product_created")
  @@index([tenant_id, product_id], map: "ix_hms_stock_move_product")
  @@index([tenant_id, source, source_reference], map: "ix_hms_stock_move_source")
  @@index([tenant_id, company_id], map: "ix_hms_stock_move_tenant_company")
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model hms_stock_reservation {
  id                 String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String             @db.Uuid
  company_id         String             @db.Uuid
  product_id         String             @db.Uuid
  location_id        String             @db.Uuid
  qty                Decimal            @db.Decimal(14, 4)
  reserved_for       String?
  expires_at         DateTime?          @db.Timestamptz(6)
  created_by         String?            @db.Uuid
  created_at         DateTime           @default(now()) @db.Timestamptz(6)
  idempotency_key    String?
  status             String?            @default("active")
  updated_at         DateTime?          @default(now()) @db.Timestamptz(6)
  hms_stock_location hms_stock_location @relation(fields: [location_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([tenant_id, company_id, product_id])
}

model hms_stock_valuation {
  id             String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String         @db.Uuid
  company_id     String         @db.Uuid
  stock_move_id  String         @db.Uuid
  account_code   String?
  amount         Decimal        @db.Decimal(18, 4)
  created_at     DateTime       @default(now()) @db.Timestamptz(6)
  hms_stock_move hms_stock_move @relation(fields: [stock_move_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([tenant_id, company_id])
}

model hms_supplier {
  id                   String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id            String                 @db.Uuid
  company_id           String                 @db.Uuid
  name                 String
  metadata             Json?                  @default("{}")
  created_at           DateTime               @default(now()) @db.Timestamptz(6)
  is_active            Boolean                @default(true)
  hms_product_supplier hms_product_supplier[]
  hms_purchase_invoice hms_purchase_invoice[]
  hms_purchase_order   hms_purchase_order[]
  hms_purchase_receipt hms_purchase_receipt[]
}

model hms_tax_rule {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String   @db.Uuid
  code       String
  name       String?
  rate       Decimal  @default(0) @db.Decimal(8, 6)
  metadata   Json?    @default("{}")
  created_at DateTime @default(now()) @db.Timestamptz(6)

  @@index([tenant_id, code])
}

model hms_triage {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  encounter_id String?   @db.Uuid
  patient_id   String?   @db.Uuid
  severity     String?
  complaints   String?
  onset        String?
  risk_flags   Json?     @default("[]")
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
}

model hms_user_roles {
  id       String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id  String   @db.Uuid
  role_id  String   @db.Uuid
  hms_role hms_role @relation(fields: [role_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  app_user app_user @relation(fields: [user_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model hms_vitals {
  id           String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String?      @db.Uuid
  company_id   String?      @db.Uuid
  patient_id   String?      @db.Uuid
  encounter_id String?      @unique @db.Uuid
  recorded_at  DateTime?    @default(now()) @db.Timestamptz(6)
  temperature  Decimal?     @db.Decimal(5, 2)
  pulse        Decimal?     @db.Decimal(5, 2)
  respiration  Decimal?     @db.Decimal(5, 2)
  systolic     Decimal?     @db.Decimal(5, 2)
  diastolic    Decimal?     @db.Decimal(5, 2)
  spo2         Decimal?     @db.Decimal(5, 2)
  height       Decimal?     @db.Decimal(5, 2) // in cm
  weight       Decimal?     @db.Decimal(5, 2) // in kg
  notes        String?
  metadata     Json?        @default("{}")
  hms_patient  hms_patient? @relation(fields: [patient_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model hms_ward {
  id         String    @id @db.Uuid
  tenant_id  String    @db.Uuid
  company_id String    @db.Uuid
  name       String
  is_active  Boolean?  @default(true)
  hms_bed    hms_bed[]

  @@unique([company_id, name], map: "hms_ward_company_name_unique")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model import_job {
  id          String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  company_id  String?   @db.Uuid
  uploaded_by String?   @db.Uuid
  filename    String?
  status      String?   @default("uploaded")
  summary     Json?     @default("{}")
  error       String?
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

model invoice_sequences {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String?   @db.Uuid
  company_id   String?   @db.Uuid
  prefix       String
  next_number  BigInt    @default(1)
  padding      Int?      @default(5) @db.SmallInt
  yearly_reset Boolean?  @default(false)
  updated_at   DateTime? @default(now()) @db.Timestamptz(6)
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model journal_entries {
  id                         String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                  String                @db.Uuid
  company_id                 String                @db.Uuid
  journal_id                 String?               @db.Uuid
  ref                        String?
  date                       DateTime              @default(now()) @db.Date
  posted                     Boolean?              @default(false)
  posted_at                  DateTime?             @db.Timestamptz(6)
  created_by                 String?               @db.Uuid
  created_at                 DateTime?             @default(now()) @db.Timestamptz(6)
  metadata                   Json?                 @default("{}")
  invoice_id                 String?               @db.Uuid
  currency_id                String?               @db.Uuid
  amount_in_company_currency Decimal?              @db.Decimal(18, 6)
  fx_rate                    Decimal?              @db.Decimal(18, 6)
  purchase_invoice_id        String?               @db.Uuid
  currencies                 currencies?           @relation(fields: [currency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_invoice                hms_invoice?          @relation(fields: [invoice_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journals                   journals?             @relation(fields: [journal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_purchase_invoice       hms_purchase_invoice? @relation(fields: [purchase_invoice_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journal_entry_lines        journal_entry_lines[]
  journal_lines              journal_lines[]

  @@index([company_id], map: "idx_journal_entries_company")
  @@index([invoice_id], map: "idx_journal_entries_invoice_id")
  @@index([purchase_invoice_id], map: "idx_journal_entries_purchase_invoice_id")
  @@index([journal_id], map: "idx_journal_entries_journal")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model journal_entry_lines {
  id                  String             @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String             @db.Uuid
  company_id          String             @db.Uuid
  journal_entry_id    String             @db.Uuid
  account_id          String             @db.Uuid
  debit               Decimal?           @default(0) @db.Decimal(18, 6)
  credit              Decimal?           @default(0) @db.Decimal(18, 6)
  partner_id          String?            @db.Uuid
  tax_type_id         String?            @db.Uuid
  tax_rate_id         String?            @db.Uuid
  description         String?
  created_at          DateTime?          @default(now()) @db.Timestamptz(6)
  analytic_account_id String?            @db.Uuid
  analytic_tag_ids    String[]           @default([]) @db.Uuid
  is_tax_line         Boolean?           @default(false)
  metadata            Json?              @default("{}")
  accounts            accounts           @relation(fields: [account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  analytic_accounts   analytic_accounts? @relation(fields: [analytic_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journal_entries     journal_entries    @relation(fields: [journal_entry_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([account_id], map: "idx_jel_account")
  @@index([company_id], map: "idx_jel_company")
}

model journal_lines {
  id               String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String          @db.Uuid
  company_id       String          @db.Uuid
  journal_entry_id String          @db.Uuid
  account_id       String          @db.Uuid
  partner_id       String?         @db.Uuid
  debit            Decimal?        @default(0) @db.Decimal(18, 2)
  credit           Decimal?        @default(0) @db.Decimal(18, 2)
  tax_rate_id      String?         @db.Uuid
  tax_type_id      String?         @db.Uuid
  created_at       DateTime?       @default(now()) @db.Timestamptz(6)
  updated_at       DateTime?       @default(now()) @db.Timestamptz(6)
  accounts         accounts        @relation(fields: [account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journal_entries  journal_entries @relation(fields: [journal_entry_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model journal_sequences {
  id           String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String   @db.Uuid
  company_id   String   @db.Uuid
  journal_id   String   @unique @db.Uuid
  prefix       String
  next_number  BigInt   @default(1)
  padding      Int      @default(5)
  reset_period String   @default("YEAR")
  created_at   DateTime @default(now()) @db.Timestamptz(6)
  journals     journals @relation(fields: [journal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model journal_types {
  id            String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  code          String          @unique
  name          String
  description   String?
  created_at    DateTime        @default(now()) @db.Timestamptz(6)
  posting_rules posting_rules[]
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model journals {
  id                                                                                    String                        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                                             String                        @db.Uuid
  company_id                                                                            String                        @db.Uuid
  code                                                                                  String
  name                                                                                  String
  type                                                                                  String
  default_debit_account_id                                                              String?                       @db.Uuid
  default_credit_account_id                                                             String?                       @db.Uuid
  created_at                                                                            DateTime?                     @default(now()) @db.Timestamptz(6)
  company_accounting_settings_company_accounting_settings_bank_journal_idTojournals     company_accounting_settings[] @relation("company_accounting_settings_bank_journal_idTojournals")
  company_accounting_settings_company_accounting_settings_cash_journal_idTojournals     company_accounting_settings[] @relation("company_accounting_settings_cash_journal_idTojournals")
  company_accounting_settings_company_accounting_settings_general_journal_idTojournals  company_accounting_settings[] @relation("company_accounting_settings_general_journal_idTojournals")
  company_accounting_settings_company_accounting_settings_purchase_journal_idTojournals company_accounting_settings[] @relation("company_accounting_settings_purchase_journal_idTojournals")
  company_accounting_settings_company_accounting_settings_sales_journal_idTojournals    company_accounting_settings[] @relation("company_accounting_settings_sales_journal_idTojournals")
  journal_entries                                                                       journal_entries[]
  journal_sequences                                                                     journal_sequences?
  accounts_journals_default_credit_account_idToaccounts                                 accounts?                     @relation("journals_default_credit_account_idToaccounts", fields: [default_credit_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  accounts_journals_default_debit_account_idToaccounts                                  accounts?                     @relation("journals_default_debit_account_idToaccounts", fields: [default_debit_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([company_id], map: "idx_journals_company")
}

model lab_test_group {
  id         String   @id @db.Uuid
  tenant_id  String   @db.Uuid
  company_id String   @db.Uuid
  name       String
  is_active  Boolean? @default(true)
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model lead {
  id                 String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String                   @db.Uuid
  company_id         String?                  @db.Uuid
  owner_id           String?                  @db.Uuid
  pipeline_id        String?                  @db.Uuid
  stage_id           String?                  @db.Uuid
  name               String
  primary_email      String?
  primary_phone      String?
  source_id          String?                  @db.Uuid
  status             String?                  @default("new")
  estimated_value    Decimal?                 @default(0) @db.Decimal
  probability        Decimal?                 @default(0) @db.Decimal
  priority           Int?                     @default(3) @db.SmallInt
  custom_data        Json?                    @default("{}")
  tags               String[]                 @default([])
  meta               Json?                    @default("{}")
  created_by         String?                  @db.Uuid
  created_at         DateTime?                @default(now()) @db.Timestamptz(6)
  updated_at         DateTime?                @default(now()) @db.Timestamptz(6)
  metadata           Json?                    @default("{}")
  search_vector      Unsupported("tsvector")?
  stage              String?                  @default("new")
  primary_phone_e164 String?
  profession_id      String?                  @db.Uuid
  profession_name    String?
  industry_id        String?                  @db.Uuid

  @@index([industry_id], map: "idx_lead_industry_id")
  @@index([profession_id], map: "idx_lead_profession_id")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_activity {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id    String    @db.Uuid
  tenant_id  String    @db.Uuid
  actor_id   String?   @db.Uuid
  actor_type String?   @default("user")
  action_key String
  payload    Json?     @default("{}")
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  company_id String?   @db.Uuid

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_assignment {
  id            String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id       String    @db.Uuid
  tenant_id     String    @db.Uuid
  assigned_from String?   @db.Uuid
  assigned_to   String?   @db.Uuid
  assigned_by   String?   @db.Uuid
  reason        String?
  created_at    DateTime? @default(now()) @db.Timestamptz(6)
  company_id    String?   @db.Uuid

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_assignment_history {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String?   @db.Uuid
  lead_id    String    @db.Uuid
  rule_id    String?   @db.Uuid
  from_owner String?   @db.Uuid
  to_owner   String    @db.Uuid
  reason     String?
  created_by String?   @db.Uuid
  created_at DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_assignment_rule {
  id          String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String?   @db.Uuid
  pipeline_id String?   @db.Uuid
  criteria    Json
  assign_to   String    @db.Uuid
  priority    Int?      @default(100)
  active      Boolean?  @default(true)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_duplicate {
  id           String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  lead_id      String    @db.Uuid
  duplicate_of String    @db.Uuid
  score        Decimal   @db.Decimal
  status       String?   @default("pending")
  created_at   DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_event {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  lead_id    String?   @db.Uuid
  event_key  String
  payload    Json?     @default("{}")
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  company_id String?   @db.Uuid

  @@ignore
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model lead_followups {
  id             BigInt    @id @default(autoincrement())
  tenant_id      String    @db.Uuid
  company_id     String?   @db.Uuid
  lead_id        String    @db.Uuid
  due_at         DateTime  @db.Timestamptz(6)
  status         String    @default("planned")
  note           String?
  created_by     String?   @db.Uuid
  changed_by     String?   @db.Uuid
  change_reason  String?
  version        Int       @default(1)
  effective_from DateTime  @default(now()) @db.Timestamptz(6)
  effective_to   DateTime? @db.Timestamptz(6)
  created_at     DateTime  @default(now()) @db.Timestamptz(6)
  updated_at     DateTime  @default(now()) @db.Timestamptz(6)
  due_date_local DateTime? @db.Date

  @@index([company_id], map: "idx_lf_company")
  @@index([created_by], map: "idx_lf_created_by")
  @@index([due_at], map: "idx_lf_due")
  @@index([tenant_id, lead_id], map: "idx_lf_tenant_lead")
  @@index([tenant_id, status, effective_to, due_at], map: "idx_lf_tenant_status_effective_due")
}

model lead_history {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String   @db.Uuid
  lead_id    String   @db.Uuid
  event_type String
  field_key  String?
  old_value  Json?
  new_value  Json?
  meta       Json?
  created_by String?  @db.Uuid
  created_at DateTime @default(now()) @db.Timestamptz(6)

  @@unique([tenant_id, lead_id, field_key], map: "ux_lead_history_tenant_lead_field")
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model lead_industry {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  name        String
  description String?
  is_active   Boolean?  @default(true)
  created_by  String?   @db.Uuid
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  deleted_at  DateTime? @db.Timestamptz(6)
  deleted_by  String?   @db.Uuid

  @@index([deleted_at], map: "idx_lead_industry_deleted_at")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_note {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id    String    @db.Uuid
  tenant_id  String    @db.Uuid
  author_id  String?   @db.Uuid
  body       String
  visibility String?   @default("internal")
  metadata   Json?     @default("{}")
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  company_id String?   @db.Uuid

  @@ignore
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model lead_pipeline {
  id          String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String       @db.Uuid
  name        String
  description String?
  is_active   Boolean?     @default(true)
  created_by  String?      @db.Uuid
  created_at  DateTime?    @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?    @default(now()) @db.Timestamptz(6)
  deleted_at  DateTime?    @db.Timestamptz(6)
  deleted_by  String?      @db.Uuid
  lead_stage  lead_stage[]

  @@index([deleted_at], map: "idx_lead_pipeline_deleted_at")
  @@index([tenant_id], map: "idx_lead_pipeline_tenant")
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model lead_profession {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  name        String
  category    String?
  description String?
  is_active   Boolean?  @default(true)
  created_by  String?   @db.Uuid
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  deleted_at  DateTime? @db.Timestamptz(6)
  deleted_by  String?   @db.Uuid

  @@index([deleted_at], map: "idx_lead_profession_deleted_at")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_schedule {
  id           String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String?   @db.Uuid
  lead_id      String    @db.Uuid
  title        String
  note         String?
  scheduled_at DateTime  @db.Timestamptz(6)
  assignee_id  String?   @db.Uuid
  done_at      DateTime? @db.Timestamptz(6)
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime  @default(now()) @db.Timestamptz(6)
  company_id   String?   @db.Uuid

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_source {
  id          String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  key         String
  name        String
  config      Json?     @default("{}")
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)
  description String?
  is_active   Boolean?  @default(true)
  deleted_at  DateTime? @db.Timestamptz(6)
  deleted_by  String?   @db.Uuid

  @@index([deleted_at], map: "idx_lead_source_deleted_at")
  @@index([is_active], map: "idx_lead_source_is_active")
  @@ignore
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model lead_stage {
  id                  String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String?       @db.Uuid
  pipeline_id         String        @db.Uuid
  name                String
  order               Int?          @default(1000)
  is_won              Boolean?      @default(false)
  is_lost             Boolean?      @default(false)
  is_active           Boolean?      @default(true)
  default_probability Decimal?      @default(0) @db.Decimal(5, 2)
  created_by          String?       @db.Uuid
  created_at          DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?     @default(now()) @db.Timestamptz(6)
  lead_pipeline       lead_pipeline @relation(fields: [pipeline_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "fk_lead_stage_pipeline")

  @@index([pipeline_id, order], map: "idx_lead_stage_pipeline_order")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_stage_history {
  id            String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id       String    @db.Uuid
  from_stage_id String?   @db.Uuid
  to_stage_id   String?   @db.Uuid
  changed_by    String?   @db.Uuid
  reason        String?
  created_at    DateTime? @default(now()) @db.Timestamptz(6)
  tenant_id     String    @db.Uuid
  from_stage    String?
  to_stage      String?

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_tag {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_id    String    @db.Uuid
  tag_id     String    @db.Uuid
  created_at DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_task {
  id           String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  lead_id      String    @db.Uuid
  title        String
  due_date     DateTime? @db.Date
  status       String    @default("open")
  assigned_to  String?   @db.Uuid
  created_by   String    @db.Uuid
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  completed_at DateTime? @db.Timestamptz(6)
  company_id   String?   @db.Uuid

  @@index([company_id], map: "idx_lead_task_company")
  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_template {
  id          String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String?   @db.Uuid
  key         String
  name        String
  description String?
  spec        Json
  scope       Json?     @default("{}")
  is_active   Boolean?  @default(true)
  created_by  String?   @db.Uuid
  updated_by  String?   @db.Uuid
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model lead_template_pipeline_map {
  id                   String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  lead_template_id     String    @db.Uuid
  pipeline_template_id String    @db.Uuid
  created_at           DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model ledger_posting_rules {
  id                                                                  String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                           String         @db.Uuid
  company_id                                                          String         @db.Uuid
  source_type                                                         String
  debit_account_id                                                    String?        @db.Uuid
  credit_account_id                                                   String?        @db.Uuid
  description                                                         String?
  created_at                                                          DateTime       @default(now()) @db.Timestamptz(6)
  account_chart_ledger_posting_rules_credit_account_idToaccount_chart account_chart? @relation("ledger_posting_rules_credit_account_idToaccount_chart", fields: [credit_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  account_chart_ledger_posting_rules_debit_account_idToaccount_chart  account_chart? @relation("ledger_posting_rules_debit_account_idToaccount_chart", fields: [debit_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model loyalty_customer_points {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  company_id  String    @db.Uuid
  customer_id String    @db.Uuid
  points      Decimal?  @default(0) @db.Decimal(12, 2)
  updated_at  DateTime? @default(now()) @db.Timestamptz(6)

  @@unique([company_id, customer_id])
}

model loyalty_program {
  id           String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String         @db.Uuid
  company_id   String         @db.Uuid
  name         String
  earn_rate    Decimal        @db.Decimal(10, 2)
  redeem_rate  Decimal        @db.Decimal(10, 2)
  is_active    Boolean?       @default(true)
  created_at   DateTime?      @default(now()) @db.Timestamptz(6)
  loyalty_rule loyalty_rule[]
}

model loyalty_rule {
  id              String          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  program_id      String          @db.Uuid
  rule_type       String
  config          Json            @default("{}")
  loyalty_program loyalty_program @relation(fields: [program_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model loyalty_transaction {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  company_id  String    @db.Uuid
  customer_id String    @db.Uuid
  change      Decimal   @db.Decimal(12, 2)
  reason      String?
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
}

model manufacturing_bom {
  id                     String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String                   @db.Uuid
  company_id             String                   @db.Uuid
  product_id             String                   @db.Uuid
  code                   String?
  name                   String
  quantity               Decimal?                 @default(1) @db.Decimal(14, 4)
  uom                    String?                  @default("unit")
  version                Int?                     @default(1)
  is_active              Boolean?                 @default(true)
  created_at             DateTime?                @default(now()) @db.Timestamptz(6)
  manufacturing_bom_line manufacturing_bom_line[]
}

model manufacturing_bom_line {
  id                String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id         String            @db.Uuid
  company_id        String            @db.Uuid
  bom_id            String            @db.Uuid
  component_id      String            @db.Uuid
  quantity          Decimal           @db.Decimal(18, 6)
  uom_id            String?           @db.Uuid
  created_by        String?           @db.Uuid
  created_at        DateTime?         @default(now()) @db.Timestamp(6)
  manufacturing_bom manufacturing_bom @relation(fields: [bom_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model manufacturing_consumption {
  id                  String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String              @db.Uuid
  company_id          String              @db.Uuid
  order_id            String              @db.Uuid
  component_id        String              @db.Uuid
  quantity            Decimal             @db.Decimal(18, 6)
  created_by          String?             @db.Uuid
  created_at          DateTime?           @default(now()) @db.Timestamp(6)
  manufacturing_order manufacturing_order @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model manufacturing_order {
  id                            String                          @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                     String                          @db.Uuid
  company_id                    String                          @db.Uuid
  product_id                    String                          @db.Uuid
  bom_id                        String                          @db.Uuid
  routing_id                    String?                         @db.Uuid
  quantity                      Decimal                         @db.Decimal(18, 6)
  status                        String                          @default("draft")
  planned_start                 DateTime?                       @db.Timestamp(6)
  planned_end                   DateTime?                       @db.Timestamp(6)
  actual_start                  DateTime?                       @db.Timestamp(6)
  actual_end                    DateTime?                       @db.Timestamp(6)
  created_by                    String?                         @db.Uuid
  created_at                    DateTime?                       @default(now()) @db.Timestamp(6)
  updated_at                    DateTime?                       @default(now()) @db.Timestamp(6)
  manufacturing_consumption     manufacturing_consumption[]
  manufacturing_order_operation manufacturing_order_operation[]
  manufacturing_production      manufacturing_production[]
}

model manufacturing_order_operation {
  id                   String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  order_id             String              @db.Uuid
  routing_operation_id String              @db.Uuid
  status               String?             @default("pending")
  started_at           DateTime?           @db.Timestamp(6)
  finished_at          DateTime?           @db.Timestamp(6)
  manufacturing_order  manufacturing_order @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model manufacturing_production {
  id                  String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String              @db.Uuid
  company_id          String              @db.Uuid
  order_id            String              @db.Uuid
  product_id          String              @db.Uuid
  quantity            Decimal             @db.Decimal(18, 6)
  created_by          String?             @db.Uuid
  created_at          DateTime?           @default(now()) @db.Timestamp(6)
  manufacturing_order manufacturing_order @relation(fields: [order_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model manufacturing_routing {
  id                              String                            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                       String                            @db.Uuid
  company_id                      String                            @db.Uuid
  name                            String
  description                     String?
  is_active                       Boolean?                          @default(true)
  created_by                      String?                           @db.Uuid
  created_at                      DateTime?                         @default(now()) @db.Timestamp(6)
  manufacturing_routing_operation manufacturing_routing_operation[]
}

model manufacturing_routing_operation {
  id                       String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                String                   @db.Uuid
  company_id               String                   @db.Uuid
  routing_id               String                   @db.Uuid
  workcenter_id            String                   @db.Uuid
  sequence                 Int?                     @default(1)
  duration_minutes         Int?                     @default(0)
  created_by               String?                  @db.Uuid
  created_at               DateTime?                @default(now()) @db.Timestamp(6)
  manufacturing_routing    manufacturing_routing    @relation(fields: [routing_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  manufacturing_workcenter manufacturing_workcenter @relation(fields: [workcenter_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model manufacturing_workcenter {
  id                              String                            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                       String                            @db.Uuid
  company_id                      String                            @db.Uuid
  name                            String
  capacity_per_hour               Decimal?                          @db.Decimal(18, 4)
  cost_per_hour                   Decimal?                          @db.Decimal(18, 4)
  is_active                       Boolean?                          @default(true)
  created_by                      String?                           @db.Uuid
  created_at                      DateTime?                         @default(now()) @db.Timestamp(6)
  manufacturing_routing_operation manufacturing_routing_operation[]
}

model menu_audit_log {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  menu_item_id String?   @db.Uuid
  tenant_id    String?   @db.Uuid
  company_id   String?   @db.Uuid
  event        String
  old_value    Json?
  new_value    Json?
  changed_by   String?   @db.Uuid
  changed_at   DateTime? @default(now()) @db.Timestamptz(6)
}

model menu_items {
  id                     String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  parent_id              String?                  @db.Uuid
  module_key             String
  key                    String
  label                  String
  icon                   String?
  url                    String?
  sort_order             Int?                     @default(100)
  feature_flag           String?
  permission_code        String?
  is_global              Boolean                  @default(true)
  created_at             DateTime?                @default(now()) @db.Timestamptz(6)
  updated_at             DateTime?                @default(now()) @db.Timestamptz(6)
  company_menu_overrides company_menu_overrides[]
  menu_items             menu_items?              @relation("menu_itemsTomenu_items", fields: [parent_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  other_menu_items       menu_items[]             @relation("menu_itemsTomenu_items")
  module_menu_map        module_menu_map[]
  tenant_menu_overrides  tenant_menu_overrides[]

  @@index([module_key], map: "idx_menu_module")
  @@index([parent_id], map: "idx_menu_parent")
}

model message {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  user_id      String    @db.Uuid
  title        String
  body         String?
  from_user_id String?   @db.Uuid
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  read         Boolean?  @default(false)

  @@index([tenant_id, user_id, read], map: "idx_message_tenant_user")
}

model module_menu_map {
  id           String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  module_key   String
  menu_item_id String     @db.Uuid
  created_at   DateTime?  @default(now()) @db.Timestamptz(6)
  menu_items   menu_items @relation(fields: [menu_item_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  modules      modules    @relation(fields: [module_key], references: [module_key], onDelete: NoAction, onUpdate: NoAction)

  @@unique([module_key, menu_item_id])
}

model modules {
  id              String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  module_key      String            @unique
  name            String
  description     String?
  is_active       Boolean           @default(true)
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  updated_at      DateTime?         @default(now()) @db.Timestamptz(6)
  module_menu_map module_menu_map[]
  tenant_module   tenant_module[]
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model opportunity {
  id                  String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String    @db.Uuid
  lead_id             String?   @db.Uuid
  pipeline_id         String    @db.Uuid
  stage_id            String    @db.Uuid
  name                String
  amount              Decimal?  @db.Decimal
  probability         Decimal?  @db.Decimal
  expected_close_date DateTime? @db.Date
  status              String?   @default("open")
  created_at          DateTime? @default(now()) @db.Timestamptz(6)
  updated_at          DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model payment_allocations {
  id                    String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id             String   @db.Uuid
  company_id            String   @db.Uuid
  payment_id            String   @db.Uuid
  document_type         String
  document_id           String   @db.Uuid
  allocated_amount      Decimal  @db.Decimal(18, 6)
  allocated_base_amount Decimal? @db.Decimal(18, 6)
  fx_rate               Decimal? @db.Decimal(18, 6)
  created_at            DateTime @default(now()) @db.Timestamptz(6)
}

model payment_lines {
  id                       String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                String?   @db.Uuid
  company_id               String    @db.Uuid
  payment_id               String    @db.Uuid
  invoice_id               String?   @db.Uuid
  invoice_journal_entry_id String?   @db.Uuid
  amount                   Decimal   @default(0) @db.Decimal(20, 6)
  created_at               DateTime? @default(now()) @db.Timestamptz(6)
  metadata                 Json?     @default("{}")

  @@index([invoice_id], map: "idx_payment_lines_invoice")
  @@index([payment_id], map: "idx_payment_lines_payment")
}

model payment_reconciliation_details {
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String?   @db.Uuid
  company_id      String    @db.Uuid
  payment_id      String    @db.Uuid
  payment_line_id String?   @db.Uuid
  invoice_id      String?   @db.Uuid
  amount          Decimal   @default(0) @db.Decimal(20, 6)
  created_by      String?   @db.Uuid
  created_at      DateTime? @default(now()) @db.Timestamptz(6)
  metadata        Json?     @default("{}")

  @@index([invoice_id], map: "idx_payrec_invoice")
  @@index([payment_id], map: "idx_payrec_payment")
}

model payments {
  id                        String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                 String?   @db.Uuid
  company_id                String    @db.Uuid
  payment_number            String?
  payment_number_normalized String?
  partner_id                String?   @db.Uuid
  journal_id                String?   @db.Uuid
  method                    String?
  amount                    Decimal   @default(0) @db.Decimal(20, 6)
  currency_id               String?   @db.Uuid
  reference                 String?
  posted                    Boolean?  @default(false)
  posted_at                 DateTime? @db.Timestamptz(6)
  journal_entry_id          String?   @db.Uuid
  created_by                String?   @db.Uuid
  created_at                DateTime? @default(now()) @db.Timestamptz(6)
  updated_at                DateTime? @default(now()) @db.Timestamptz(6)
  metadata                  Json?     @default("{}")

  @@index([journal_entry_id], map: "idx_payments_journal_entry_id")
  @@index([tenant_id, payment_number_normalized], map: "idx_payments_number_norm")
  @@index([tenant_id, company_id], map: "idx_payments_tenant_company")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model periods {
  id             String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id      String        @db.Uuid
  company_id     String        @db.Uuid
  fiscal_year_id String?       @db.Uuid
  name           String
  date_start     DateTime      @db.Date
  date_end       DateTime      @db.Date
  state          String        @default("open")
  created_at     DateTime?     @default(now()) @db.Timestamptz(6)
  fiscal_years   fiscal_years? @relation(fields: [fiscal_year_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
}

model permission {
  code            String            @id
  name            String
  description     String?
  category        String?
  is_deprecated   Boolean?          @default(false)
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  role_permission role_permission[]
  user_permission user_permission[]
}

model crm_leads {
  id                 String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String            @db.Uuid
  company_id         String?           @db.Uuid
  /// Link to app_user
  owner_id           String?           @db.Uuid
  pipeline_id        String?           @db.Uuid
  stage_id           String?           @db.Uuid
  source_id          String?           @db.Uuid
  /// Lead Name / Title
  name               String
  /// Person Name
  contact_name       String?
  /// Organization Name
  company_name       String?
  email              String?
  phone              String?
  /// new, contacted, qualified, lost, converted
  status             String?           @default("new")
  estimated_value    Decimal?          @default(0) @db.Decimal(18, 2)
  probability        Decimal?          @default(0) @db.Decimal(5, 2)
  next_followup_date DateTime?         @db.Timestamptz(6)
  last_activity_date DateTime?         @db.Timestamptz(6)
  lead_score         Int?              @default(0)
  ai_summary         String?
  is_hot             Boolean?          @default(false)
  /// Soft Delete
  deleted_at         DateTime?         @db.Timestamptz(6)
  metadata           Json?             @default("{}")
  created_at         DateTime          @default(now()) @db.Timestamptz(6)
  updated_at         DateTime          @default(now()) @db.Timestamptz(6)
  currency           String?           @default("INR")
  target_type_id     String?           @db.Uuid
  activities         crm_activities[]
  owner              app_user?         @relation(fields: [owner_id], references: [id])
  pipeline           crm_pipelines?    @relation(fields: [pipeline_id], references: [id])
  source             crm_sources?      @relation(fields: [source_id], references: [id])
  stage              crm_stages?       @relation(fields: [stage_id], references: [id])
  target_type        crm_target_types? @relation(fields: [target_type_id], references: [id])

  @@index([tenant_id, status])
  @@index([next_followup_date])
  @@index([deleted_at])
}

model crm_contacts {
  id         String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String        @db.Uuid
  company_id String?       @db.Uuid
  owner_id   String?       @db.Uuid
  first_name String
  last_name  String?
  email      String?
  phone      String?
  job_title  String?
  account_id String?       @db.Uuid
  deleted_at DateTime?     @db.Timestamptz(6)
  created_at DateTime      @default(now()) @db.Timestamptz(6)
  updated_at DateTime      @default(now()) @db.Timestamptz(6)
  account    crm_accounts? @relation(fields: [account_id], references: [id])
  owner      app_user?     @relation(fields: [owner_id], references: [id])
}

model crm_accounts {
  id         String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String         @db.Uuid
  owner_id   String?        @db.Uuid
  name       String
  industry   String?
  website    String?
  phone      String?
  deleted_at DateTime?      @db.Timestamptz(6)
  created_at DateTime       @default(now()) @db.Timestamptz(6)
  updated_at DateTime       @default(now()) @db.Timestamptz(6)
  owner      app_user?      @relation(fields: [owner_id], references: [id])
  contacts   crm_contacts[]
  deals      crm_deals[]
}

model crm_deals {
  id                  String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String            @db.Uuid
  owner_id            String?           @db.Uuid
  title               String
  value               Decimal           @default(0) @db.Decimal(18, 2)
  currency            String            @default("USD")
  pipeline_id         String?           @db.Uuid
  stage_id            String?           @db.Uuid
  account_id          String?           @db.Uuid
  contact_id          String?           @db.Uuid
  expected_close_date DateTime?         @db.Date
  probability         Decimal?          @default(0) @db.Decimal(5, 2)
  /// open, won, lost
  status              String?           @default("open")
  lost_reason_id      String?           @db.Uuid
  deleted_at          DateTime?         @db.Timestamptz(6)
  created_at          DateTime          @default(now()) @db.Timestamptz(6)
  updated_at          DateTime          @default(now()) @db.Timestamptz(6)
  activities          crm_activities[]
  commissions         crm_commissions[]
  account             crm_accounts?     @relation(fields: [account_id], references: [id])
  lost_reason         crm_lost_reasons? @relation(fields: [lost_reason_id], references: [id])
  owner               app_user?         @relation(fields: [owner_id], references: [id])
  pipeline            crm_pipelines?    @relation(fields: [pipeline_id], references: [id])
  stage               crm_stages?       @relation(fields: [stage_id], references: [id])
}

model crm_pipelines {
  id         String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String       @db.Uuid
  name       String
  is_default Boolean      @default(false)
  deleted_at DateTime?    @db.Timestamptz(6)
  created_at DateTime     @default(now()) @db.Timestamptz(6)
  deals      crm_deals[]
  leads      crm_leads[]
  stages     crm_stages[]
}

model crm_stages {
  id          String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  pipeline_id String        @db.Uuid
  name        String
  /// open, won, lost
  type        String        @default("open")
  probability Decimal       @default(0) @db.Decimal(5, 2)
  sort_order  Int           @default(0)
  deleted_at  DateTime?     @db.Timestamptz(6)
  deals       crm_deals[]
  leads       crm_leads[]
  pipeline    crm_pipelines @relation(fields: [pipeline_id], references: [id], onDelete: Cascade)
}

model crm_sources {
  id         String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String      @db.Uuid
  name       String
  deleted_at DateTime?   @db.Timestamptz(6)
  created_at DateTime    @default(now()) @db.Timestamptz(6)
  leads      crm_leads[]
}

model crm_lost_reasons {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String      @db.Uuid
  name        String      @map("reason")
  deleted_at  DateTime?   @db.Timestamptz(6)
  created_at  DateTime    @default(now()) @db.Timestamptz(6)
  description String?
  is_active   Boolean?    @default(true)
  deals       crm_deals[]

  @@index([tenant_id], map: "idx_crm_lost_reasons_tenant")
}

model crm_activities {
  id              String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String     @db.Uuid
  owner_id        String?    @db.Uuid
  /// lead, deal, contact, account
  related_to_type String
  related_to_id   String     @db.Uuid
  /// call, meeting, email, note, task
  type            String
  subject         String
  description     String?
  due_date        DateTime?  @db.Timestamptz(6)
  completed_at    DateTime?  @db.Timestamptz(6)
  /// pending, completed, overdue, cancelled
  status          String     @default("pending")
  /// -100 to 100
  sentiment_score Int?
  location_lat    Decimal?   @db.Decimal(10, 8)
  location_lng    Decimal?   @db.Decimal(11, 8)
  deleted_at      DateTime?  @db.Timestamptz(6)
  created_at      DateTime   @default(now()) @db.Timestamptz(6)
  lead_id         String?    @db.Uuid
  deal_id         String?    @db.Uuid
  deal            crm_deals? @relation(fields: [deal_id], references: [id])
  lead            crm_leads? @relation(fields: [lead_id], references: [id])
}

model crm_attendance {
  id                 String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String    @db.Uuid
  user_id            String    @db.Uuid
  date               DateTime  @db.Date
  check_in           DateTime? @db.Timestamptz(6)
  check_out          DateTime? @db.Timestamptz(6)
  /// { lat: ..., lng: ..., address: ... }
  check_in_location  Json?
  check_out_location Json?
  /// present, absent, half_day, late
  status             String    @default("present")
  notes              String?
  created_at         DateTime  @default(now()) @db.Timestamptz(6)
}

model crm_targets {
  id               String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String    @db.Uuid
  /// user, role, team
  assignee_type    String
  /// user_id or role_id
  assignee_id      String    @db.Uuid
  /// week, month, quarter, year
  period_type      String
  period_start     DateTime  @db.Date
  period_end       DateTime  @db.Date
  /// revenue, count
  target_type      String
  target_value     Decimal   @db.Decimal(18, 2)
  achieved_value   Decimal?  @default(0) @db.Decimal(18, 2)
  deleted_at       DateTime? @db.Timestamptz(6)
  created_at       DateTime  @default(now()) @db.Timestamptz(6)
  incentive_amount Decimal?  @default(0) @db.Decimal(18, 2)
  milestones       crm_target_milestones[]
}

model crm_target_milestones {
  id             String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  target_id      String      @db.Uuid
  step_order     Int
  name           String
  /// calls, deals_created, pipeline_value, revenue, activities
  metric_type    String
  target_value   Decimal     @db.Decimal(18, 2)
  achieved_value Decimal     @default(0) @db.Decimal(18, 2)
  deadline       DateTime    @db.Date
  /// pending, passed, failed
  status         String      @default("pending")
  is_blocking    Boolean     @default(true)
  created_at     DateTime    @default(now()) @db.Timestamptz(6)
  target         crm_targets @relation(fields: [target_id], references: [id], onDelete: Cascade)

  @@index([target_id])
}

model crm_commission_rules {
  id               String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String    @db.Uuid
  name             String
  /// role, user
  assignee_type    String
  assignee_id      String    @db.Uuid
  /// percentage, flat
  calculation_type String
  /// 5.00% or 500.00
  value            Decimal   @db.Decimal(10, 2)
  trigger_event    String    @default("deal_won")
  is_active        Boolean   @default(true)
  deleted_at       DateTime? @db.Timestamptz(6)
  created_at       DateTime  @default(now()) @db.Timestamptz(6)
}

model crm_commissions {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  user_id    String    @db.Uuid
  deal_id    String    @db.Uuid
  amount     Decimal   @db.Decimal(18, 2)
  /// pending, paid, cancelled
  status     String    @default("pending")
  paid_at    DateTime?
  deleted_at DateTime? @db.Timestamptz(6)
  created_at DateTime  @default(now()) @db.Timestamptz(6)
  deal       crm_deals @relation(fields: [deal_id], references: [id])
}

model crm_custom_fields {
  id          String              @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String              @db.Uuid
  /// lead, deal, contact, account
  entity_type String
  key         String
  label       String
  /// text, number, date, select, boolean
  field_type  String
  /// for select
  options     Json?
  required    Boolean             @default(false)
  sort_order  Int                 @default(0)
  deleted_at  DateTime?           @db.Timestamptz(6)
  created_at  DateTime            @default(now()) @db.Timestamptz(6)
  values      crm_custom_values[]

  @@unique([tenant_id, entity_type, key])
}

model crm_custom_values {
  id            String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  field_id      String            @db.Uuid
  /// lead_id, deal_id etc
  record_id     String            @db.Uuid
  value_text    String?
  value_number  Decimal?
  value_date    DateTime?
  value_boolean Boolean?
  value_json    Json?
  field         crm_custom_fields @relation(fields: [field_id], references: [id], onDelete: Cascade)

  @@unique([field_id, record_id])
}

model pos_payment_method {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String   @db.Uuid
  company_id String   @db.Uuid
  name       String
  type       String
  is_active  Boolean? @default(true)
}

model pos_profile {
  id            String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String       @db.Uuid
  company_id    String       @db.Uuid
  terminal_id   String       @db.Uuid
  price_list_id String?      @db.Uuid
  tax_inclusive Boolean?     @default(false)
  created_at    DateTime?    @default(now()) @db.Timestamptz(6)
  pos_terminal  pos_terminal @relation(fields: [terminal_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model pos_register {
  id           String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String        @db.Uuid
  company_id   String        @db.Uuid
  store_id     String        @db.Uuid
  name         String
  status       String?       @default("closed")
  created_at   DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?     @default(now()) @db.Timestamptz(6)
  retail_store retail_store  @relation(fields: [store_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  pos_session  pos_session[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model pos_session {
  id           String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String       @db.Uuid
  company_id   String       @db.Uuid
  register_id  String       @db.Uuid
  opened_by    String       @db.Uuid
  opened_at    DateTime?    @default(now()) @db.Timestamptz(6)
  closed_at    DateTime?    @db.Timestamptz(6)
  status       String?      @default("open")
  pos_register pos_register @relation(fields: [register_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model pos_store {
  id           String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String         @db.Uuid
  company_id   String         @db.Uuid
  name         String
  address      String?
  is_active    Boolean?       @default(true)
  created_at   DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?      @default(now()) @db.Timestamptz(6)
  pos_terminal pos_terminal[]
}

model pos_tax_template {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String   @db.Uuid
  company_id String   @db.Uuid
  name       String
  rate       Decimal  @db.Decimal(10, 2)
  is_active  Boolean? @default(true)
}

model pos_terminal {
  id            String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String        @db.Uuid
  company_id    String        @db.Uuid
  store_id      String        @db.Uuid
  terminal_name String
  is_active     Boolean?      @default(true)
  created_at    DateTime?     @default(now()) @db.Timestamptz(6)
  updated_at    DateTime?     @default(now()) @db.Timestamptz(6)
  pos_profile   pos_profile[]
  pos_store     pos_store     @relation(fields: [store_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model posting_rules {
  id                                                           String        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                    String        @db.Uuid
  company_id                                                   String        @db.Uuid
  journal_type_id                                              String        @db.Uuid
  debit_account_id                                             String        @db.Uuid
  credit_account_id                                            String        @db.Uuid
  description                                                  String?
  created_at                                                   DateTime      @default(now()) @db.Timestamptz(6)
  account_chart_posting_rules_credit_account_idToaccount_chart account_chart @relation("posting_rules_credit_account_idToaccount_chart", fields: [credit_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  account_chart_posting_rules_debit_account_idToaccount_chart  account_chart @relation("posting_rules_debit_account_idToaccount_chart", fields: [debit_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journal_types                                                journal_types @relation(fields: [journal_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model product {
  id                     String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String                   @db.Uuid
  company_id             String                   @db.Uuid
  name                   String
  description            String?
  category_id            String?                  @db.Uuid
  is_active              Boolean?                 @default(true)
  has_variants           Boolean?                 @default(false)
  sku                    String?
  price                  Decimal?                 @db.Decimal(12, 2)
  cost_price             Decimal?                 @db.Decimal(12, 2)
  created_at             DateTime?                @default(now()) @db.Timestamptz(6)
  updated_at             DateTime?                @default(now()) @db.Timestamptz(6)
  code                   String?
  type                   String?
  uom_id                 String?                  @db.Uuid
  product_category       product_category?        @relation(fields: [category_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  product_variant        product_variant[]
  promotion_product_link promotion_product_link[]

  @@index([tenant_id, company_id], map: "idx_product_tenant")
}

model product_attribute {
  id                      String                    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id               String                    @db.Uuid
  company_id              String                    @db.Uuid
  name                    String
  is_active               Boolean?                  @default(true)
  product_attribute_value product_attribute_value[]
}

model product_attribute_value {
  id                String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  attribute_id      String            @db.Uuid
  name              String
  product_attribute product_attribute @relation(fields: [attribute_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

/// This model contains an expression index which requires additional setup for migrations. Visit https://pris.ly/d/expression-indexes for more info.
model product_category {
  id         String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  company_id String    @db.Uuid
  name       String
  is_active  Boolean?  @default(true)
  created_at DateTime? @default(now()) @db.Timestamptz(6)
  updated_at DateTime? @default(now()) @db.Timestamptz(6)
  product    product[]
}

model product_tax_rules {
  id               String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id        String?      @db.Uuid
  company_id       String?      @db.Uuid
  priority         Int          @default(100)
  hsn_prefix       String?
  product_category String?
  tax_rate_id      String       @db.Uuid
  description      String?
  is_active        Boolean      @default(true)
  created_at       DateTime     @default(now()) @db.Timestamptz(6)
  updated_at       DateTime     @default(now()) @db.Timestamptz(6)
  product_id       String?      @db.Uuid
  hms_product      hms_product? @relation(fields: [product_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  tax_rates        tax_rates    @relation(fields: [tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([hsn_prefix], map: "idx_product_tax_rules_hsn_prefix")
  @@index([product_category], map: "idx_product_tax_rules_prod_cat")
}

model product_variant {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  company_id   String    @db.Uuid
  product_id   String    @db.Uuid
  variant_name String
  sku          String?   @unique
  price        Decimal?  @db.Decimal(12, 2)
  barcode      String?
  created_at   DateTime? @default(now()) @db.Timestamptz(6)
  updated_at   DateTime? @default(now()) @db.Timestamptz(6)
  product      product   @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([product_id], map: "idx_product_variant_product")
}

model promo_campaign {
  id         String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String       @db.Uuid
  company_id String       @db.Uuid
  name       String
  start_date DateTime?    @db.Date
  end_date   DateTime?    @db.Date
  is_active  Boolean?     @default(true)
  created_at DateTime?    @default(now()) @db.Timestamptz(6)
  promo_rule promo_rule[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model promo_rule {
  id             String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  campaign_id    String         @db.Uuid
  rule_type      String?
  percentage     Decimal?       @db.Decimal(10, 2)
  fixed_amount   Decimal?       @db.Decimal(10, 2)
  buy_qty        Int?
  get_qty        Int?
  applied_on     String?
  product_id     String?        @db.Uuid
  category_id    String?        @db.Uuid
  created_at     DateTime?      @default(now()) @db.Timestamptz(6)
  promo_campaign promo_campaign @relation(fields: [campaign_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model promo_usage {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  company_id  String    @db.Uuid
  campaign_id String    @db.Uuid
  user_id     String?   @db.Uuid
  order_id    String?   @db.Uuid
  discount    Decimal?  @db.Decimal(10, 2)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
}

model promotion {
  id                     String                   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String                   @db.Uuid
  company_id             String                   @db.Uuid
  name                   String
  start_date             DateTime?                @db.Date
  end_date               DateTime?                @db.Date
  is_active              Boolean?                 @default(true)
  created_at             DateTime?                @default(now()) @db.Timestamptz(6)
  promotion_action       promotion_action[]
  promotion_condition    promotion_condition[]
  promotion_product_link promotion_product_link[]
}

model promotion_action {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  promotion_id String    @db.Uuid
  action_type  String
  config       Json
  promotion    promotion @relation(fields: [promotion_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model promotion_condition {
  id             String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  promotion_id   String    @db.Uuid
  condition_type String
  config         Json
  promotion      promotion @relation(fields: [promotion_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model promotion_product_link {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  promotion_id String    @db.Uuid
  product_id   String    @db.Uuid
  product      product   @relation(fields: [product_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  promotion    promotion @relation(fields: [promotion_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
}

model provisioning_jobs {
  id           String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String    @db.Uuid
  company_id   String    @db.Uuid
  user_id      String    @db.Uuid
  payload      Json?
  status       String    @default("queued")
  attempts     Int       @default(0)
  last_error   String?
  scheduled_at DateTime? @db.Timestamptz(6)
  started_at   DateTime? @db.Timestamptz(6)
  finished_at  DateTime? @db.Timestamptz(6)
  created_at   DateTime  @default(now()) @db.Timestamptz(6)
  updated_at   DateTime  @default(now()) @db.Timestamptz(6)

  @@index([status, scheduled_at], map: "idx_provisioning_jobs_status")
}

/// This model contains row level security and requires additional setup for migrations. Visit https://pris.ly/d/row-level-security for more info.
model reconciliations {
  id                     String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id              String    @db.Uuid
  company_id             String    @db.Uuid
  name                   String?
  journal_entry_line_ids String[]  @default([]) @db.Uuid
  state                  String?   @default("open")
  created_at             DateTime? @default(now()) @db.Timestamptz(6)

  @@index([company_id], map: "idx_reconciliations_company")
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model refresh_tokens {
  rid                    String
  sid                    String
  user_id                String    @db.Uuid
  tenant_id              String?   @db.Uuid
  token_hash             String?
  revoked                Boolean   @default(false)
  replaced_by_token_hash String?
  created_at             DateTime  @default(now()) @db.Timestamptz(6)
  expires_at             DateTime? @db.Timestamptz(6)

  @@ignore
}

model retail_settings {
  company_id        String    @id @db.Uuid
  default_tax_id    String?   @db.Uuid
  enable_loyalty    Boolean?  @default(false)
  enable_promotions Boolean?  @default(false)
  created_at        DateTime? @default(now()) @db.Timestamptz(6)
  updated_at        DateTime? @default(now()) @db.Timestamptz(6)
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model retail_store {
  id           String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id    String         @db.Uuid
  company_id   String         @db.Uuid
  name         String
  code         String?
  store_type   String?
  address      String?
  is_active    Boolean?       @default(true)
  created_at   DateTime?      @default(now()) @db.Timestamptz(6)
  updated_at   DateTime?      @default(now()) @db.Timestamptz(6)
  pos_register pos_register[]
}

model role {
  id              String            @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String?           @db.Uuid
  key             String
  name            String
  permissions     String[]          @default([])
  created_at      DateTime?         @default(now()) @db.Timestamptz(6)
  role_permission role_permission[]
}

model role_permission {
  role_id         String     @db.Uuid
  permission_code String
  tenant_id       String?    @db.Uuid
  is_granted      Boolean    @default(true)
  created_at      DateTime?  @default(now()) @db.Timestamptz(6)
  permission      permission @relation(fields: [permission_code], references: [code], onDelete: Cascade, onUpdate: NoAction)
  role            role       @relation(fields: [role_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([role_id, permission_code])
  @@index([permission_code], map: "idx_role_permission_code")
}

model sessions {
  sid             String    @id @unique(map: "sessions_sid_idx")
  user_id         String    @db.Uuid
  tenant_id       String?   @db.Uuid
  device          String?
  issued_at       DateTime  @default(now()) @db.Timestamptz(6)
  last_seen       DateTime  @default(now()) @db.Timestamptz(6)
  meta            Json?     @default("{}")
  absolute_expiry DateTime? @db.Timestamptz(6)
  created_at      DateTime  @default(now()) @db.Timestamptz(6)
  company_id      String?   @db.Uuid
  company         company?  @relation(fields: [company_id], references: [id], onUpdate: NoAction)
}

model setting_schemas {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  key         String    @unique
  json_schema Json
  description String?
  version     Int?      @default(1)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
}

/// The underlying table does not contain a valid unique identifier and can therefore currently not be handled by Prisma Client.
model tag {
  id         String    @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String    @db.Uuid
  key        String
  name       String
  metadata   Json?     @default("{}")
  created_at DateTime? @default(now()) @db.Timestamptz(6)

  @@ignore
}

model tax_gl_accounts {
  id                                                                     String         @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                                                              String         @db.Uuid
  company_id                                                             String         @db.Uuid
  tax_rate_id                                                            String         @db.Uuid
  output_account_id                                                      String         @db.Uuid
  input_account_id                                                       String         @db.Uuid
  reverse_charge_account_id                                              String?        @db.Uuid
  created_at                                                             DateTime       @default(now()) @db.Timestamptz(6)
  account_chart_tax_gl_accounts_input_account_idToaccount_chart          account_chart  @relation("tax_gl_accounts_input_account_idToaccount_chart", fields: [input_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  account_chart_tax_gl_accounts_output_account_idToaccount_chart         account_chart  @relation("tax_gl_accounts_output_account_idToaccount_chart", fields: [output_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  account_chart_tax_gl_accounts_reverse_charge_account_idToaccount_chart account_chart? @relation("tax_gl_accounts_reverse_charge_account_idToaccount_chart", fields: [reverse_charge_account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tax_rates                                                              tax_rates      @relation(fields: [tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([company_id, tax_rate_id])
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model tax_posting_rules {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  company_id  String    @db.Uuid
  tax_rate_id String    @db.Uuid
  behavior    String
  created_at  DateTime  @default(now()) @db.Timestamptz(6)
  tax_rates   tax_rates @relation(fields: [tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([company_id, tax_rate_id])
}

model tax_rates {
  id                                                                                         String                        @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tax_type_id                                                                                String                        @db.Uuid
  name                                                                                       String                        @db.VarChar(50)
  rate                                                                                       Decimal                       @db.Decimal(6, 3)
  is_active                                                                                  Boolean                       @default(true)
  created_at                                                                                 DateTime                      @default(now()) @db.Timestamptz(6)
  updated_at                                                                                 DateTime                      @default(now()) @db.Timestamptz(6)
  company_accounting_settings_company_accounting_settings_default_purchase_tax_idTotax_rates company_accounting_settings[] @relation("company_accounting_settings_default_purchase_tax_idTotax_rates")
  company_accounting_settings_company_accounting_settings_default_sale_tax_idTotax_rates     company_accounting_settings[] @relation("company_accounting_settings_default_sale_tax_idTotax_rates")
  company_settings                                                                           company_settings[]
  company_tax_maps                                                                           company_tax_maps[]
  country_tax_mappings                                                                       country_tax_mappings[]
  fiscal_position_tax_map_fiscal_position_tax_map_from_tax_idTotax_rates                     fiscal_position_tax_map[]     @relation("fiscal_position_tax_map_from_tax_idTotax_rates")
  fiscal_position_tax_map_fiscal_position_tax_map_to_tax_idTotax_rates                       fiscal_position_tax_map[]     @relation("fiscal_position_tax_map_to_tax_idTotax_rates")
  hms_invoice_lines                                                                          hms_invoice_lines[]
  hms_product_category                                                                       hms_product_category[]
  product_tax_rules                                                                          product_tax_rules[]
  tax_gl_accounts                                                                            tax_gl_accounts[]
  tax_posting_rules                                                                          tax_posting_rules[]
  tax_types                                                                                  tax_types                     @relation(fields: [tax_type_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant_enabled_tax_rates                                                                   tenant_enabled_tax_rates[]

  @@index([tax_type_id], map: "idx_tax_rates_tax_type_id")
}

model tax_types {
  id                   String                 @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name                 String                 @unique @db.VarChar(50)
  description          String?
  is_active            Boolean                @default(true)
  created_at           DateTime               @default(now()) @db.Timestamptz(6)
  updated_at           DateTime               @default(now()) @db.Timestamptz(6)
  company_settings     company_settings[]
  company_tax_maps     company_tax_maps[]
  country_tax_mappings country_tax_mappings[]
  tax_rates            tax_rates[]
}

model tenant {
  id                    String                  @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  slug                  String
  name                  String
  billing_plan          String?
  metadata              Json?                   @default("{}")
  created_at            DateTime?               @default(now()) @db.Timestamptz(6)
  tenant_id             String?                 @default(dbgenerated("uuid_generate_v4()")) @db.Uuid
  domain                String?                 @db.Citext
  deleted_at            DateTime?               @db.Timestamptz(6)
  mode                  String                  @default("trial")
  company_settings      company_settings[]
  domain_mappings       domain_mappings[]
  domain_policies       domain_policies[]
  tenant_menu_overrides tenant_menu_overrides[]
  tenant_module         tenant_module[]
}

model tenant_enabled_currencies {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String     @db.Uuid
  currency_id String     @db.Uuid
  is_default  Boolean    @default(false)
  created_at  DateTime   @default(now()) @db.Timestamptz(6)
  currencies  currencies @relation(fields: [currency_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([tenant_id, currency_id])
}

model tenant_enabled_tax_rates {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  tax_rate_id String    @db.Uuid
  is_default  Boolean   @default(false)
  created_at  DateTime  @default(now()) @db.Timestamptz(6)
  tax_rates   tax_rates @relation(fields: [tax_rate_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([tenant_id, tax_rate_id])
}

model tenant_menu_overrides {
  id                  String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id           String     @db.Uuid
  menu_item_id        String     @db.Uuid
  enabled             Boolean?
  label_override      String?
  url_override        String?
  sort_order_override Int?
  created_at          DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at          DateTime?  @default(now()) @db.Timestamptz(6)
  menu_items          menu_items @relation(fields: [menu_item_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  tenant              tenant     @relation(fields: [tenant_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@unique([tenant_id, menu_item_id])
  @@index([tenant_id], map: "idx_tmo_tenant")
}

model tenant_module {
  id         String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id  String   @db.Uuid
  module_key String
  enabled    Boolean  @default(true)
  created_at DateTime @default(now()) @db.Timestamptz(6)
  updated_at DateTime @default(now()) @db.Timestamptz(6)
  module_id  String?  @db.Uuid
  modules    modules? @relation(fields: [module_id], references: [id], onDelete: NoAction, onUpdate: NoAction, map: "fk_tm_module")
  tenant     tenant   @relation(fields: [tenant_id], references: [id], onDelete: Cascade, onUpdate: NoAction, map: "tenant_module_tenant_fkey")

  @@unique([tenant_id, module_key], map: "idx_tenant_module_unique")
  @@unique([tenant_id, module_key], map: "uq_tenant_module_mod")
  @@index([tenant_id], map: "idx_tenant_module_tenant")
}

model user_companies {
  tenant_id  String   @db.Uuid
  user_id    String   @db.Uuid
  company_id String   @db.Uuid
  is_default Boolean  @default(false)
  created_at DateTime @default(now()) @db.Timestamptz(6)

  @@id([tenant_id, user_id, company_id])
  @@index([tenant_id, company_id], map: "idx_user_companies_company")
  @@index([tenant_id, user_id], map: "idx_user_companies_user")
}

model user_permission {
  user_id         String     @db.Uuid
  tenant_id       String     @db.Uuid
  permission_code String
  is_granted      Boolean    @default(true)
  created_at      DateTime?  @default(now()) @db.Timestamptz(6)
  permission      permission @relation(fields: [permission_code], references: [code], onDelete: Cascade, onUpdate: NoAction)
  app_user        app_user   @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@id([user_id, tenant_id, permission_code])
  @@index([user_id, tenant_id], map: "idx_user_permission_user_tenant")
}

model user_role {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id     String    @db.Uuid
  role_id     String    @db.Uuid
  assigned_at DateTime? @default(now()) @db.Timestamptz(6)
  tenant_id   String?   @db.Uuid

  @@unique([tenant_id, user_id, role_id], map: "ux_user_role_tenant_user_role")
  @@index([role_id, tenant_id], map: "idx_user_role_role_tenant")
  @@index([user_id, tenant_id], map: "idx_user_role_user_tenant")
}

model prescription {
  id                 String               @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id          String               @db.Uuid
  company_id         String?              @db.Uuid
  patient_id         String               @db.Uuid
  doctor_id          String?              @db.Uuid
  visit_date         DateTime             @default(now()) @db.Timestamptz(6)
  vitals             String?
  diagnosis          String?
  complaint          String?
  examination        String?
  plan               String?
  created_at         DateTime             @default(now()) @db.Timestamptz(6)
  updated_at         DateTime             @default(now()) @db.Timestamptz(6)
  appointment_id     String?              @db.Uuid
  hms_appointment    hms_appointments?    @relation(fields: [appointment_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  hms_patient        hms_patient          @relation(fields: [patient_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  prescription_items prescription_items[]

  @@index([patient_id], map: "idx_prescription_patient")
  @@index([tenant_id], map: "idx_prescription_tenant")
  @@index([created_at(sort: Desc)], map: "idx_prescription_created")
}

model prescription_items {
  id              String       @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  prescription_id String       @db.Uuid
  medicine_id     String       @db.Uuid
  morning         Int          @default(0)
  afternoon       Int          @default(0)
  evening         Int          @default(0)
  night           Int          @default(0)
  days            Int          @default(3)
  created_at      DateTime     @default(now()) @db.Timestamptz(6)
  hms_product     hms_product  @relation(fields: [medicine_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  prescription    prescription @relation(fields: [prescription_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([prescription_id], map: "idx_prescription_items_prescription")
  @@index([medicine_id], map: "idx_prescription_items_medicine")
}

model hms_prescription_template {
  id          String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String   @db.Uuid
  name        String
  description String?
  medicines   Json
  created_at  DateTime @default(now()) @db.Timestamptz(6)
  updated_at  DateTime @default(now()) @db.Timestamptz(6)
  complaint   String?
  diagnosis   String?
  examination String?
  plan        String?
  vitals      String?

  @@index([tenant_id], map: "idx_presc_template_tenant")
}

model crm_contact_roles {
  id          String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String    @db.Uuid
  name        String
  description String?
  is_active   Boolean?  @default(true)
  created_at  DateTime? @default(now()) @db.Timestamptz(6)
  deleted_at  DateTime? @db.Timestamptz(6)

  @@index([tenant_id], map: "idx_crm_contact_roles_tenant")
}

model crm_target_types {
  id          String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id   String      @db.Uuid
  name        String
  description String?
  is_active   Boolean?    @default(true)
  created_at  DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?   @default(now()) @db.Timestamptz(6)
  deleted_at  DateTime?   @db.Timestamptz(6)
  leads       crm_leads[]

  @@index([tenant_id])
}

enum StockMoveType {
  RECEIPT
  ISSUE
  TRANSFER
  ADJUSTMENT
  SALE
  RETURN
  DAMAGED
}

enum appointment_status {
  scheduled
  confirmed
  cancelled
  completed
  no_show
}

enum hms_invoice_status {
  draft
  posted
  paid
  cancelled
  void
}

enum hms_location_type {
  warehouse
  pharmacy
  ward
  theatre
  lab
  transit
  consumed
}

enum hms_move_type {
  in
  out
  internal
  adjustment
  reservation
  return
}

enum hms_payment_method {
  cash
  card
  upi
  bank_transfer
  insurance
  adjustment
}

enum hms_purchase_status {
  draft
  confirmed
  approved
  partially_received
  received
  billed
  closed
  cancelled
}

enum hms_receipt_status {
  pending
  received
  partially_received
  closed
  cancelled
}

enum visit_status {
  active
  completed
  cancelled
  no_show
}

model hms_staff_attendance {
  id              String    @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String    @db.Uuid
  company_id      String?   @db.Uuid
  user_id         String    @db.Uuid
  check_in        DateTime  @default(now()) @db.Timestamptz(6)
  check_out       DateTime? @db.Timestamptz(6)
  status          String    @default("present") // present, late, auto_checkout
  location_in     Json?     // {lat, lng, ip, city}
  location_out    Json?
  device_info     Json?     // Browser, OS, Device
  break_duration  Int       @default(0) // in minutes
  metadata        Json?     @default("{}")
  productivity_score Decimal? @db.Decimal(5, 2)
  created_at      DateTime  @default(now()) @db.Timestamptz(6)
  updated_at      DateTime  @default(now()) @db.Timestamptz(6)

  @@index([user_id, check_in])
  @@index([tenant_id, company_id])
}

model hms_staff_shift {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String   @db.Uuid
  company_id    String?  @db.Uuid
  name          String
  start_time    String   // "09:00"
  end_time      String   // "17:00"
  grace_period  Int      @default(15) // minutes allowed late
  work_days     String[] // ["Monday", "..."]
  color         String?  @default("#6366f1") // For UI calendar
  is_active     Boolean  @default(true)
  created_at    DateTime @default(now()) @db.Timestamptz(6)
}

model hms_staff_roster {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String   @db.Uuid
  company_id    String?  @db.Uuid
  user_id       String   @db.Uuid
  shift_id      String   @db.Uuid
  date          DateTime @db.Date
  status        String   @default("scheduled") // scheduled, confirmed, cancelled
  notes         String?
  created_at    DateTime @default(now()) @db.Timestamptz(6)

  @@index([user_id, date])
  @@index([shift_id, date])
}

model hms_emergency_broadcast {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id     String   @db.Uuid
  sender_id     String   @db.Uuid
  message       String
  priority      String   @default("high") // normal, high, critical
  type          String   @default("general") // general, evacuation, code_blue, staffing
  expires_at    DateTime @db.Timestamptz(6)
  created_at    DateTime @default(now()) @db.Timestamptz(6)

  @@index([tenant_id, expires_at])
}

model hms_broadcast_ack {
  id            String   @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  broadcast_id  String   @db.Uuid
  user_id       String   @db.Uuid
  acknowledged_at DateTime @default(now()) @db.Timestamptz(6)

  @@index([broadcast_id])
  @@index([user_id])
}
