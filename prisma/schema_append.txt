
model journal_entries {
  id                         String                @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id                  String                @db.Uuid
  company_id                 String                @db.Uuid
  journal_id                 String?               @db.Uuid
  ref                        String?
  date                       DateTime              @db.Date
  posted                     Boolean?              @default(false)
  posted_at                  DateTime?             @db.Timestamptz(6)
  created_by                 String?               @db.Uuid
  created_at                 DateTime?             @default(now()) @db.Timestamptz(6)
  metadata                   Json?                 @default("{}")
  invoice_id                 String?               @db.Uuid
  currency_id                String?               @db.Uuid
  amount_in_company_currency Decimal?              @db.Decimal(18, 2)
  fx_rate                    Decimal?              @default(1) @db.Decimal(18, 6)
  is_posted                  Boolean?              @default(false)
  is_locked                  Boolean?              @default(false)
  locked_at                  DateTime?             @db.Timestamptz(6)
  
  // Relations
  hms_invoice                hms_invoice?          @relation(fields: [invoice_id], references: [id], onDelete: NoAction, onUpdate: NoAction)
  journal_entry_lines        journal_entry_lines[]

  @@index([tenant_id, company_id], map: "idx_journal_entries_tenant_company")
  @@index([date], map: "idx_journal_entries_date")
  @@index([invoice_id], map: "idx_journal_entries_invoice")
}

model journal_entry_lines {
  id              String           @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  tenant_id       String           @db.Uuid
  company_id      String           @db.Uuid
  journal_entry_id String          @db.Uuid
  account_id      String           @db.Uuid
  debit           Decimal          @default(0) @db.Decimal(18, 2)
  credit          Decimal          @default(0) @db.Decimal(18, 2)
  description     String?
  partner_id      String?          @db.Uuid
  metadata        Json?            @default("{}")
  created_at      DateTime?        @default(now()) @db.Timestamptz(6)

  // Relations
  journal_entries journal_entries  @relation(fields: [journal_entry_id], references: [id], onDelete: Cascade, onUpdate: NoAction)
  accounts        account_chart    @relation(fields: [account_id], references: [id], onDelete: NoAction, onUpdate: NoAction)

  @@index([journal_entry_id], map: "idx_journal_entry_lines_entry")
  @@index([account_id], map: "idx_journal_entry_lines_account")
}
